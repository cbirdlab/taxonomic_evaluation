<!DOCTYPE html>
<html class=""><head>

  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="application/shiny-singletons"></script>
  <script type="application/html-dependencies">json2[2014.02.04];jquery[1.12.4];shiny[1.0.4]</script>
<script src="report_files/json2-min.js"></script>
<script src="report_files/jquery.js"></script>
<link href="report_files/shiny.css" rel="stylesheet">
<script src="report_files/shiny.js"></script>  <script src="report_files/rmd_loader.js"></script>
  <link href="report_files/rmd_loader.css" rel="stylesheet">

<meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="report_files/bootstrap.css"><script src="report_files/bootstrap.js"></script><script src="report_files/html5shiv.js"></script><script src="report_files/respond.js"></script><script src="report_files/tabsets.js"></script><link rel="stylesheet" type="text/css" href="report_files/default.css"><script src="report_files/highlight.js"></script><link rel="stylesheet" type="text/css" href="report_files/rmd_perf.css"><script src="report_files/rmd_perf.js"></script><meta name="rstudio_origin" content="127.0.0.1:20571"><script src="report_files/rsiframe.js"></script>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="pandoc">


<meta name="author" content="Evan Krell, Chris Bird, Martin French">


<title>Evaluation of Taxonomic Assignment Packages V3</title>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


<script type="text/javascript" src="report_files/MathJax.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

<body><div id="MathJax_Message" style="display: none;"></div>
  <div>
    <div data-display-if="!output.__reactivedoc__" data-ns-prefix="" style="display: none;">
      <div id="rmd_loader_wrapper">
        <div id="rmd_loader" style="">
          <img src="report_files/rmd_loader.gif">
          <p>Loading</p>
        </div>
      </div>
    </div>
    <div id="__reactivedoc__" class="shiny-html-output shiny-bound-output">







<style type="text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});
</script>

<!-- code folding -->






<div class="fluid-row" id="section-header">



<h1 class="title toc-ignore">Evaluation of Taxonomic Assignment Packages V3</h1>
<h4 class="author"><em>Evan Krell, Chris Bird, Martin French</em></h4>
<h4 class="date"><em>December 1, 2016</em></h4>

</div>


<div id="section-database-used" class="section level2">
<h2>Database used</h2>
<p>The database used for taxonomic assignment is the pre-built nucleotide BLAST database from NCBI.</p>
<p><a href="https://blast.ncbi.nlm.nih.gov/Blast.cgi?CMD=Web&amp;PAGE_TYPE=BlastDocs&amp;DOC_TYPE=Download" class="uri">https://blast.ncbi.nlm.nih.gov/Blast.cgi?CMD=Web&amp;PAGE_TYPE=BlastDocs&amp;DOC_TYPE=Download</a></p>
<p>Filter options were used to reduce the database to only mitochondrial
 DNA. An entrez query was made to download the GI numbers for those 
sequences, with the the following command:</p>
<pre><code>wget 'https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=nuccore&amp;term=mitochondria or cytochrome \\
or coi or co1 or cox1 or coxi or "mitochondrial genome" or "mitochondria genome"&amp;retmax=4933739'</code></pre>
</div>
<div id="section-sources-of-taxonomic-assignment" class="section level2">
<h2>Sources of taxonomic assignment</h2>
<p><strong>Vsearch</strong></p>
<p><a href="https://github.com/torognes/vsearch" class="uri">https://github.com/torognes/vsearch</a></p>
<p>Command used:</p>
<pre><code>vsearch --db ../nr_mito.fasta --id .7 \\
--userout OTU.vsearched.userout --usearch_global \\
/media/Wapuilani/evan/Charybdis_Runs/Combined/out/Simons.combo.nonchimeras.clean.OTU.cluster.fasta</code></pre>
<p><strong>Ecotag</strong></p>
<p><a href="http://metabarcoding.org/obitools/doc/scripts/ecotag.html" class="uri">http://metabarcoding.org/obitools/doc/scripts/ecotag.html</a></p>
<p>Command used:</p>
<pre><code>ecotag -R /media/Wapuilani/Databases/FILTER_BLASTDB/ecopcrdb/db_clean_uniq_valid.fasta -m .7 \\
-t /media/Wapuilani/Databases/NCBI_TAXO \\
-r /media/Wapuilani/evan/Charybdis_Runs/Combined/out/Simons.combo.nonchimeras.clean.OTU.cluster.fasta</code></pre>
<p><strong>Blast</strong></p>
<p><a href="https://blast.ncbi.nlm.nih.gov/Blast.cgi" class="uri">https://blast.ncbi.nlm.nih.gov/Blast.cgi</a></p>
<p>Command used:</p>
<pre><code>blastn -query /media/Wapuilani/evan/Charybdis_Runs/Combined/out/Simons.combo.nonchimeras.clean.OTU.cluster.fasta \\
-db ./nr_mito &gt; Simons_NDB.blast.csv</code></pre>
<p><strong>SAP</strong></p>
<p><a href="https://github.com/kaspermunch/sap" class="uri">https://github.com/kaspermunch/sap</a></p>
<p>Command used:</p>
<pre><code>sap --project Simons8 --database /media/Wapuilani/Databases/FILTER_DB/nr_mito.SAP.fix.fasta \
/media/Wapualani/evan/Charybdis/Simons/combo/out/Simons....fasta</code></pre>
</div>
<div id="section-load-and-prepare-data" class="section level2">
<h2>Load and prepare data</h2>
<p>In this section, the data sources are loaded and processed in various
 ways to get them ready for evaluation. Care is taken to make sure that 
all data are as consistent as possible. By using a common database, all 
taxonomic assignment software use the same GI numbers to identify the 
assigned reference sequences.</p>
</div>
<div id="section-filter-singletons" class="section level2">
<h2>Filter singletons</h2>
<p>In order to reduce amount of junk assignments, remove based on the following criteria:</p>
<ol style="list-style-type: decimal">
<li>Singleton (type 1): The read count across all samples is 1</li>
<li>Singleton (type 2): The read count in any single sample is never &gt; 1</li>
<li>Singleton (type 3): The read count in any single sample is never greater than 1% of total count across all samples</li>
</ol>
<p>Need to print this info</p>
<table class="table table-condensed">
<thead>
<tr class="header">
<th></th>
<th align="center">Vsearch</th>
<th align="center">Ecotag</th>
<th align="center">Blast</th>
<th align="right">SAP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Singletons (type 1)</td>
<td align="center">2054</td>
<td align="center">4393</td>
<td align="center">4382</td>
<td align="right">91</td>
</tr>
<tr class="even">
<td>Singletons (type 2)</td>
<td align="center">225</td>
<td align="center">341</td>
<td align="center">340</td>
<td align="right">17</td>
</tr>
<tr class="odd">
<td>Singletons (type 3)</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>Total Filtered OTUs</td>
<td align="center">2279</td>
<td align="center">4734</td>
<td align="center">4722</td>
<td align="right">108</td>
</tr>
<tr class="odd">
<td>Remaining OTUs</td>
<td align="center">469</td>
<td align="center">819</td>
<td align="center">807</td>
<td align="right">155</td>
</tr>
</tbody>
</table>
</div>
<div id="section-overview" class="section level2">
<h2>Overview</h2>
<p>The following table compares the number of OTUs present in the data produced for each method of taxonomic assignment.</p>
<p>In addition, the table shows the number of unique reference 
assignments for each assignment method, as well as the intersection of 
all three: the number of OTUs that were assigned to the same reference 
sequence.</p>
<table class="table table-condensed">
<thead>
<tr class="header">
<th></th>
<th align="center">Vsearch</th>
<th align="center">Ecotag</th>
<th align="center">Blast</th>
<th align="right">SAP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Number of Assigned OTUs</td>
<td align="center">2749</td>
<td align="center">5587</td>
<td align="center">5584</td>
<td align="right">155</td>
</tr>
<tr class="even">
<td>Total OTUs</td>
<td align="center">5636</td>
<td align="center">5636</td>
<td align="center">5636</td>
<td align="right">5636</td>
</tr>
<tr class="odd">
<td>Percent Assigned OTUs</td>
<td align="center">48.7757275</td>
<td align="center">99.1305891</td>
<td align="center">99.0773598</td>
<td align="right">2.7501774</td>
</tr>
<tr class="even">
<td>Unique Reference Sequences</td>
<td align="center">285</td>
<td align="center">578</td>
<td align="center">632</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td>Intersection of Unique Reference Sequences</td>
<td align="center">17</td>
<td align="center">17</td>
<td align="center">17</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td>Percent References Sequences Shared</td>
<td align="center">5.9649123</td>
<td align="center">2.9411765</td>
<td align="center">2.6898734</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p><img src="report_files/venn-1.png" width="672"><img src="report_files/venn-2.png" width="672"></p>
<pre><code>## [1] "Intersection of Assigned OTUs"</code></pre>
<p><img src="report_files/venn_assigned_OTUs-1.png" width="672"><img src="report_files/venn_assigned_OTUs-2.png" width="672"></p>
<table class="table table-condensed">
<thead>
<tr class="header">
<th>Intersection</th>
<th align="right">Number of Assigned OTUs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Ecotag, Vsearch</td>
<td align="right">468</td>
</tr>
<tr class="even">
<td>Ecotag, Blast</td>
<td align="right">52</td>
</tr>
<tr class="odd">
<td>Ecotag, SAP</td>
<td align="right">155</td>
</tr>
<tr class="even">
<td>Vsearch, Blast</td>
<td align="right">462</td>
</tr>
<tr class="odd">
<td>Vsearch, SAP</td>
<td align="right">155</td>
</tr>
<tr class="even">
<td>Blast, SAP</td>
<td align="right">153</td>
</tr>
<tr class="odd">
<td>Ecotag, Vsearch, Blast</td>
<td align="right">461</td>
</tr>
<tr class="even">
<td>Ecotag, Vsearch, SAP</td>
<td align="right">155</td>
</tr>
<tr class="odd">
<td>Vsearch, Blast, SAP</td>
<td align="right">153</td>
</tr>
<tr class="even">
<td>Ecotag, Vsearch, Blast, SAP</td>
<td align="right">153</td>
</tr>
</tbody>
</table>
</div>
<div id="section-investigate-phylogenetic-levels-of-taxonomic-assingment-of-otus" class="section level2">
<h2>Investigate phylogenetic levels of taxonomic assingment of OTUs</h2>
<p>The following table shows, for each phylogenetic level, the number of
 OTU assignments where that level was the lowest assignment. This table 
may also reveal issues where there is not lowest. This could be some 
kind of error with the assignment, or a behavior of the assignment 
package. For example, ecotag keeps all data in the results. The 
sequences that it cannot assign, it assigns to the “root” of the 
phylogenetic tree.</p>
<pre class="r"><code class="r"><span class="comment">## SAP complete</span>

<span class="identifier">taxonomicRanksOfInterest</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"species"</span>, <span class="string">"genus"</span>, <span class="string">"family"</span>, <span class="string">"order"</span>, <span class="string">"class"</span>, <span class="string">"phylum"</span>, <span class="string">"kingdom"</span><span class="paren">)</span>

<span class="comment"># Vsearch</span>
<span class="identifier">vsearch_taxonomy</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_vsearch</span><span class="paren">[</span>,<span class="identifier">taxonomicRanksOfInterest</span><span class="paren">]</span>
<span class="identifier">vsearch_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">vsearch_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">vsearch_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">vsearch_best_match_scinames</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">vsearch_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">vsearch_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">vsearch_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">vsearch_best_match_levels</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">vsearch_best_match</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">ovt_vsearch</span><span class="operator">$</span><span class="identifier">OTU_SEQID</span>, 
                                        <span class="identifier">vsearch_best_match_scinames</span>, <span class="identifier">vsearch_best_match_levels</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">vsearch_best_match</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"OTU_SEQID"</span>, <span class="string">"SCINAME"</span>, <span class="string">"LEVEL"</span><span class="paren">)</span>


<span class="comment"># Ecotag</span>
<span class="identifier">ecotag_taxonomy</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_ecotag</span><span class="paren">[</span>,<span class="identifier">taxonomicRanksOfInterest</span><span class="paren">]</span>
<span class="identifier">ecotag_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">ecotag_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">ecotag_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">ecotag_best_match_scinames</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">ecotag_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">ecotag_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">ecotag_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">ecotag_best_match_levels</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">ecotag_best_match</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">ovt_ecotag</span><span class="operator">$</span><span class="identifier">OTU_SEQID</span>, 
                                        <span class="identifier">ecotag_best_match_scinames</span>, <span class="identifier">ecotag_best_match_levels</span>, <span class="identifier">ovt_ecotag</span><span class="operator">$</span><span class="identifier">ECOTAG_IDENTITY_NT</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ecotag_best_match</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"OTU_SEQID"</span>, <span class="string">"SCINAME"</span>, <span class="string">"LEVEL"</span>, <span class="string">"ID"</span><span class="paren">)</span>


<span class="comment"># Blast</span>
<span class="identifier">blast_taxonomy</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_blast</span><span class="paren">[</span>,<span class="identifier">taxonomicRanksOfInterest</span><span class="paren">]</span>
<span class="identifier">blast_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">blast_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">blast_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">blast_best_match_scinames</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">blast_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">blast_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">blast_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">blast_best_match_levels</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">blast_best_match</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">ovt_blast</span><span class="operator">$</span><span class="identifier">OTU_SEQID</span>, 
                                        <span class="identifier">blast_best_match_scinames</span>, <span class="identifier">blast_best_match_levels</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">blast_best_match</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"OTU_SEQID"</span>, <span class="string">"SCINAME"</span>, <span class="string">"LEVEL"</span><span class="paren">)</span>


<span class="comment"># SAP</span>
<span class="identifier">sap_taxonomy</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_sap</span><span class="paren">[</span>,<span class="identifier">taxonomicRanksOfInterest</span><span class="paren">]</span>
<span class="identifier">sap_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">sap_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">sap_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">sap_best_match_scinames</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">sap_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">sap_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">sap_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">sap_best_match_levels</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">sap_best_match</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">ovt_sap</span><span class="operator">$</span><span class="identifier">OTU_SEQID</span>, 
                                        <span class="identifier">sap_best_match_scinames</span>, <span class="identifier">sap_best_match_levels</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">sap_best_match</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"OTU_SEQID"</span>, <span class="string">"SCINAME"</span>, <span class="string">"LEVEL"</span><span class="paren">)</span>



<span class="identifier">taxon_level_counts_vsearch</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">taxonomicRanksOfInterest</span>, 
                                      <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">vsearch_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">taxon_level_counts_ecotag</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">taxonomicRanksOfInterest</span>, 
                                     <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">ecotag_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">taxon_level_counts_blast</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">taxonomicRanksOfInterest</span>, 
                                     <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">blast_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">taxon_level_counts_sap</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">taxonomicRanksOfInterest</span>, 
                                     <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">sap_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>


<span class="identifier">empty_taxon_count_vsearch</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">vsearch_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="string">""</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">empty_taxon_count_ecotag</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">ecotag_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="string">""</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">empty_taxon_count_blast</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">blast_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="string">""</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">empty_taxon_count_sap</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">sap_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="string">""</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">empty_counts</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="identifier">empty_taxon_count_vsearch</span>, <span class="identifier">empty_taxon_count_ecotag</span>, <span class="identifier">empty_taxon_count_blast</span>, <span class="identifier">empty_taxon_count_sap</span><span class="paren">)</span>


<span class="identifier">total_count_vsearch</span> <span class="operator">&lt;-</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">taxon_level_counts_vsearch</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">empty_taxon_count_vsearch</span>
<span class="identifier">total_count_ecotag</span> <span class="operator">&lt;-</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">taxon_level_counts_ecotag</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">empty_taxon_count_ecotag</span>
<span class="identifier">total_count_blast</span> <span class="operator">&lt;-</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">taxon_level_counts_blast</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">empty_taxon_count_blast</span>
<span class="identifier">total_count_sap</span> <span class="operator">&lt;-</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">taxon_level_counts_sap</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">empty_taxon_count_sap</span>
<span class="identifier">total_counts</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="identifier">total_count_vsearch</span>, <span class="identifier">total_count_ecotag</span>, <span class="identifier">total_count_blast</span>, <span class="identifier">total_count_sap</span><span class="paren">)</span>


<span class="comment"># ASSERTION: total_counts should equal the nrow (ovt_XXX)</span>
    
<span class="identifier">titles_col</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"Vsearch"</span>, <span class="string">"Ecotag"</span>, <span class="string">"Blast"</span>, <span class="string">"SAP"</span><span class="paren">)</span>
<span class="identifier">counts_table</span> <span class="operator">&lt;-</span> <span class="identifier">rbind.data.frame</span> <span class="paren">(</span><span class="identifier">taxon_level_counts_vsearch</span>, <span class="identifier">taxon_level_counts_ecotag</span>, <span class="identifier">taxon_level_counts_blast</span>, <span class="identifier">taxon_level_counts_sap</span><span class="paren">)</span>
<span class="identifier">counts_table</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span><span class="paren">(</span><span class="identifier">titles_col</span>, <span class="identifier">counts_table</span>, <span class="identifier">empty_counts</span>, <span class="identifier">total_counts</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">counts_table</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"Source"</span>, <span class="identifier">taxonomicRanksOfInterest</span>, <span class="string">"unranked"</span>, <span class="string">"total"</span><span class="paren">)</span>

<span class="identifier">percent_assigned</span> <span class="operator">&lt;-</span> <span class="identifier">counts_table</span><span class="operator">$</span><span class="identifier">species</span> <span class="operator">/</span> <span class="identifier">total_counts</span>

<span class="identifier">print</span> <span class="paren">(</span><span class="identifier">counts_table</span><span class="paren">)</span></code></pre>
<pre><code>##    Source species genus family order class phylum kingdom unranked total
## 1 Vsearch     467     0      0     0     0      0       0        2   469
## 2  Ecotag     136    48     58    74    86    169     187       61   819
## 3   Blast     806     1      0     0     0      0       0        0   807
## 4     SAP      58    35     13     8    13     28       0        0   155</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="string">"Percent assigned to species level"</span><span class="paren">)</span></code></pre>
<pre><code>## [1] "Percent assigned to species level"</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="identifier">percent_assigned</span><span class="paren">)</span></code></pre>
<pre><code>## [1] 0.9957356 0.1660562 0.9987608 0.3741935</code></pre>
<pre class="r"><code class="r"><span class="comment"># bar plot of proportion assigned at species level</span>
<span class="identifier">df</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">counts_table</span><span class="operator">$</span><span class="identifier">Source</span>, <span class="identifier">percent_assigned</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"source"</span>, <span class="string">"proportions"</span><span class="paren">)</span>
<span class="identifier">ggplot</span> <span class="paren">(</span><span class="identifier">data</span><span class="operator">=</span><span class="identifier">df</span>, <span class="identifier">aes</span><span class="paren">(</span><span class="identifier">y</span><span class="operator">=</span><span class="identifier">proportions</span>, <span class="identifier">x</span><span class="operator">=</span><span class="keyword">source</span>, <span class="identifier">fill</span><span class="operator">=</span><span class="keyword">source</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">geom_bar</span><span class="paren">(</span><span class="identifier">stat</span><span class="operator">=</span><span class="string">"identity"</span>, <span class="identifier">color</span> <span class="operator">=</span> <span class="string">"black"</span> <span class="paren">)</span> <span class="operator">+</span> <span class="identifier">scale_fill_manual</span><span class="paren">(</span><span class="identifier">values</span><span class="operator">=</span><span class="identifier">c</span><span class="paren">(</span><span class="string">"#bebada"</span>, <span class="string">"#8dd3c7"</span>, <span class="string">"#ffaabc"</span>, <span class="string">"#ffffb3"</span> <span class="paren">)</span><span class="paren">)</span></code></pre>
<p><img src="report_files/phylogeny-1.png" width="672"></p>
<pre class="r"><code class="r"><span class="comment"># Explore ranks of Ecotag best matches</span>
<span class="identifier">ecotag_rank_id</span> <span class="operator">&lt;-</span> <span class="identifier">ecotag_best_match</span><span class="paren">[</span>,<span class="number">3</span><span class="operator">:</span><span class="number">4</span><span class="paren">]</span>
<span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">ecotag_rank_id</span><span class="operator">$</span><span class="identifier">LEVEL</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">{</span> <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">%in%</span> <span class="identifier">taxonomicRanksOfInterest</span><span class="paren">)</span> <span class="paren">)</span><span class="paren">{</span><span class="string">"unranked"</span><span class="paren">}</span><span class="keyword">else</span><span class="paren">{</span><span class="identifier">x</span><span class="paren">}</span><span class="paren">}</span><span class="paren">)</span></code></pre>
<pre><code>##   [1] "2"        "3"        "2"        "8"        "3"        "6"       
##   [7] "6"        "7"        "5"        "8"        "4"        "5"       
##  [13] "5"        "8"        "3"        "5"        "6"        "4"       
##  [19] "2"        "3"        "7"        "4"        "3"        "unranked"
##  [25] "4"        "unranked" "5"        "5"        "5"        "3"       
##  [31] "3"        "7"        "7"        "7"        "6"        "5"       
##  [37] "5"        "3"        "5"        "unranked" "5"        "3"       
##  [43] "7"        "unranked" "4"        "5"        "7"        "5"       
##  [49] "6"        "5"        "8"        "5"        "6"        "7"       
##  [55] "3"        "2"        "4"        "8"        "unranked" "6"       
##  [61] "8"        "6"        "7"        "8"        "8"        "2"       
##  [67] "5"        "3"        "unranked" "5"        "7"        "5"       
##  [73] "7"        "5"        "5"        "5"        "5"        "5"       
##  [79] "7"        "7"        "unranked" "6"        "5"        "7"       
##  [85] "5"        "6"        "8"        "3"        "7"        "2"       
##  [91] "7"        "2"        "6"        "6"        "5"        "6"       
##  [97] "unranked" "7"        "3"        "unranked" "5"        "unranked"
## [103] "7"        "5"        "7"        "5"        "unranked" "8"       
## [109] "7"        "7"        "8"        "2"        "5"        "3"       
## [115] "6"        "8"        "6"        "unranked" "unranked" "5"       
## [121] "2"        "8"        "2"        "2"        "5"        "5"       
## [127] "2"        "unranked" "7"        "5"        "4"        "4"       
## [133] "8"        "7"        "6"        "8"        "7"        "8"       
## [139] "3"        "7"        "5"        "5"        "7"        "7"       
## [145] "5"        "unranked" "5"        "7"        "6"        "2"       
## [151] "unranked" "unranked" "7"        "5"        "4"        "5"       
## [157] "5"        "7"        "7"        "5"        "6"        "5"       
## [163] "5"        "7"        "5"        "8"        "8"        "5"       
## [169] "4"        "2"        "3"        "6"        "7"        "8"       
## [175] "7"        "5"        "3"        "5"        "2"        "7"       
## [181] "4"        "unranked" "3"        "3"        "5"        "unranked"
## [187] "6"        "8"        "unranked" "5"        "5"        "3"       
## [193] "2"        "5"        "3"        "7"        "3"        "3"       
## [199] "7"        "7"        "7"        "5"        "6"        "5"       
## [205] "7"        "8"        "2"        "7"        "6"        "6"       
## [211] "4"        "5"        "7"        "6"        "5"        "5"       
## [217] "5"        "6"        "4"        "5"        "5"        "3"       
## [223] "5"        "8"        "2"        "7"        "7"        "8"       
## [229] "8"        "7"        "2"        "5"        "8"        "5"       
## [235] "7"        "7"        "7"        "7"        "5"        "5"       
## [241] "unranked" "7"        "6"        "5"        "7"        "7"       
## [247] "6"        "2"        "2"        "3"        "5"        "2"       
## [253] "5"        "5"        "5"        "8"        "6"        "unranked"
## [259] "2"        "5"        "7"        "4"        "8"        "2"       
## [265] "7"        "8"        "8"        "2"        "8"        "4"       
## [271] "7"        "7"        "5"        "7"        "8"        "8"       
## [277] "2"        "8"        "unranked" "7"        "4"        "4"       
## [283] "8"        "7"        "8"        "5"        "5"        "8"       
## [289] "8"        "4"        "5"        "8"        "5"        "7"       
## [295] "5"        "7"        "7"        "5"        "2"        "7"       
## [301] "6"        "7"        "8"        "6"        "8"        "8"       
## [307] "2"        "5"        "7"        "unranked" "3"        "7"       
## [313] "8"        "8"        "3"        "5"        "2"        "unranked"
## [319] "8"        "3"        "5"        "5"        "3"        "7"       
## [325] "8"        "3"        "5"        "8"        "8"        "7"       
## [331] "2"        "5"        "2"        "5"        "7"        "2"       
## [337] "unranked" "7"        "2"        "5"        "4"        "5"       
## [343] "unranked" "5"        "8"        "4"        "8"        "5"       
## [349] "8"        "7"        "2"        "8"        "8"        "2"       
## [355] "4"        "3"        "8"        "8"        "7"        "3"       
## [361] "7"        "7"        "4"        "unranked" "unranked" "2"       
## [367] "7"        "7"        "6"        "7"        "8"        "8"       
## [373] "5"        "7"        "8"        "7"        "7"        "5"       
## [379] "2"        "4"        "8"        "3"        "3"        "8"       
## [385] "7"        "6"        "8"        "3"        "8"        "2"       
## [391] "5"        "8"        "8"        "5"        "2"        "unranked"
## [397] "unranked" "8"        "7"        "6"        "unranked" "5"       
## [403] "8"        "7"        "2"        "8"        "3"        "5"       
## [409] "5"        "4"        "4"        "3"        "4"        "5"       
## [415] "2"        "7"        "8"        "8"        "2"        "5"       
## [421] "3"        "3"        "2"        "5"        "5"        "7"       
## [427] "2"        "8"        "5"        "8"        "7"        "2"       
## [433] "7"        "8"        "4"        "7"        "3"        "7"       
## [439] "unranked" "8"        "5"        "7"        "7"        "6"       
## [445] "6"        "7"        "8"        "6"        "8"        "5"       
## [451] "7"        "8"        "5"        "8"        "8"        "6"       
## [457] "4"        "6"        "2"        "8"        "5"        "2"       
## [463] "5"        "3"        "4"        "unranked" "7"        "8"       
## [469] "3"        "7"        "3"        "7"        "7"        "5"       
## [475] "2"        "unranked" "7"        "7"        "7"        "4"       
## [481] "8"        "2"        "6"        "4"        "7"        "5"       
## [487] "5"        "unranked" "4"        "3"        "5"        "4"       
## [493] "8"        "unranked" "2"        "5"        "5"        "5"       
## [499] "6"        "7"        "3"        "7"        "unranked" "8"       
## [505] "5"        "5"        "4"        "5"        "5"        "5"       
## [511] "7"        "8"        "5"        "7"        "8"        "6"       
## [517] "7"        "3"        "7"        "7"        "2"        "7"       
## [523] "8"        "unranked" "6"        "7"        "5"        "unranked"
## [529] "3"        "4"        "7"        "unranked" "7"        "8"       
## [535] "unranked" "8"        "5"        "6"        "3"        "2"       
## [541] "8"        "5"        "7"        "8"        "7"        "8"       
## [547] "7"        "8"        "6"        "7"        "8"        "7"       
## [553] "5"        "unranked" "7"        "5"        "7"        "7"       
## [559] "6"        "6"        "unranked" "unranked" "6"        "5"       
## [565] "8"        "5"        "7"        "5"        "7"        "8"       
## [571] "5"        "2"        "6"        "7"        "2"        "7"       
## [577] "4"        "7"        "5"        "5"        "7"        "7"       
## [583] "7"        "2"        "2"        "5"        "unranked" "2"       
## [589] "5"        "8"        "8"        "7"        "6"        "unranked"
## [595] "7"        "2"        "3"        "5"        "2"        "unranked"
## [601] "5"        "5"        "5"        "5"        "6"        "5"       
## [607] "7"        "7"        "5"        "8"        "5"        "5"       
## [613] "3"        "4"        "2"        "3"        "2"        "2"       
## [619] "4"        "5"        "2"        "5"        "6"        "5"       
## [625] "8"        "unranked" "unranked" "5"        "2"        "5"       
## [631] "unranked" "6"        "6"        "5"        "8"        "6"       
## [637] "5"        "7"        "unranked" "5"        "8"        "2"       
## [643] "5"        "5"        "8"        "6"        "6"        "6"       
## [649] "8"        "8"        "7"        "2"        "8"        "unranked"
## [655] "6"        "7"        "5"        "3"        "4"        "unranked"
## [661] "7"        "7"        "unranked" "6"        "2"        "4"       
## [667] "7"        "2"        "7"        "7"        "5"        "8"       
## [673] "4"        "5"        "5"        "8"        "8"        "5"       
## [679] "7"        "4"        "6"        "2"        "2"        "2"       
## [685] "7"        "7"        "5"        "2"        "5"        "7"       
## [691] "5"        "5"        "6"        "8"        "6"        "8"       
## [697] "6"        "3"        "unranked" "7"        "5"        "5"       
## [703] "8"        "2"        "6"        "unranked" "7"        "8"       
## [709] "8"        "7"        "8"        "7"        "7"        "4"       
## [715] "5"        "8"        "5"        "8"        "7"        "5"       
## [721] "7"        "7"        "7"        "2"        "3"        "8"       
## [727] "8"        "5"        "7"        "unranked" "unranked" "5"       
## [733] "2"        "5"        "5"        "5"        "3"        "8"       
## [739] "8"        "unranked" "8"        "5"        "4"        "7"       
## [745] "7"        "7"        "5"        "5"        "8"        "8"       
## [751] "5"        "3"        "5"        "4"        "8"        "2"       
## [757] "8"        "6"        "7"        "8"        "7"        "8"       
## [763] "8"        "5"        "5"        "8"        "7"        "5"       
## [769] "7"        "2"        "4"        "6"        "8"        "8"       
## [775] "5"        "5"        "7"        "2"        "8"        "5"       
## [781] "8"        "8"        "2"        "2"        "7"        "7"       
## [787] "3"        "5"        "5"        "8"        "6"        "3"       
## [793] "7"        "7"        "4"        "2"        "5"        "6"       
## [799] "6"        "4"        "5"        "5"        "2"        "7"       
## [805] "2"        "6"        "6"        "8"        "6"        "2"       
## [811] "7"        "6"        "8"        "unranked" "5"        "7"       
## [817] "2"        "6"        "2"</code></pre>
<pre class="r"><code class="r"><span class="identifier">query</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">c</span> <span class="paren">(</span><span class="identifier">taxonomicRanksOfInterest</span> <span class="paren">)</span><span class="paren">)</span> <span class="comment">#, "unranked"))</span>

<span class="comment"># bar plot rank assignments for Ecotag  </span>
<span class="identifier">proportions</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">counts_table</span><span class="paren">[</span><span class="number">2</span>,<span class="paren">]</span><span class="paren">[</span><span class="number">2</span><span class="operator">:</span><span class="number">8</span><span class="paren">]</span><span class="paren">[</span><span class="number">1</span>,<span class="paren">]</span> <span class="operator">/</span> <span class="identifier">total_counts</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>
<span class="identifier">df</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">taxon_rank</span> <span class="operator">=</span> <span class="identifier">query</span>, <span class="identifier">proportions</span><span class="paren">)</span>
<span class="identifier">ggplot</span> <span class="paren">(</span><span class="identifier">data</span><span class="operator">=</span><span class="identifier">df</span>, <span class="identifier">aes</span><span class="paren">(</span><span class="identifier">y</span><span class="operator">=</span><span class="identifier">proportions</span>, <span class="identifier">x</span><span class="operator">=</span><span class="identifier">taxon_rank</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">geom_bar</span><span class="paren">(</span><span class="identifier">stat</span><span class="operator">=</span><span class="string">"identity"</span>, <span class="identifier">fill</span> <span class="operator">=</span> <span class="string">"#8dd3c7"</span>, <span class="identifier">color</span> <span class="operator">=</span> <span class="string">"black"</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">scale_x_discrete</span> <span class="paren">(</span><span class="identifier">limits</span> <span class="operator">=</span> <span class="identifier">query</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">scale_y_continuous</span><span class="paren">(</span><span class="identifier">labels</span> <span class="operator">=</span> <span class="identifier">scales</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">percent</span><span class="paren">)</span></code></pre>
<p><img src="report_files/phylogeny-2.png" width="672"></p>
<pre class="r"><code class="r"><span class="identifier">ggplot</span> <span class="paren">(</span><span class="identifier">data</span><span class="operator">=</span><span class="identifier">ecotag_rank_id</span>, <span class="identifier">aes</span><span class="paren">(</span><span class="identifier">y</span><span class="operator">=</span><span class="identifier">ID</span>, <span class="identifier">x</span><span class="operator">=</span><span class="identifier">LEVEL</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">geom_boxplot</span><span class="paren">(</span><span class="identifier">fill</span> <span class="operator">=</span> <span class="string">"#8dd3c7"</span>, <span class="identifier">colour</span> <span class="operator">=</span> <span class="string">"black"</span> <span class="paren">)</span> <span class="operator">+</span> <span class="identifier">scale_x_discrete</span> <span class="paren">(</span><span class="identifier">limits</span> <span class="operator">=</span> <span class="identifier">query</span><span class="paren">)</span></code></pre>
<pre><code>## Warning: Removed 61 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="report_files/phylogeny-3.png" width="672"></p>
<pre class="r"><code class="r"><span class="comment"># Explore ranks of SAP best matches</span>
<span class="comment"># bar plot rank assignments for SAP</span>
<span class="identifier">query</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">c</span> <span class="paren">(</span><span class="identifier">taxonomicRanksOfInterest</span> <span class="paren">)</span><span class="paren">)</span> <span class="comment">#, "unranked"))</span>
<span class="identifier">proportions</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">counts_table</span><span class="paren">[</span><span class="number">4</span>,<span class="paren">]</span><span class="paren">[</span><span class="number">2</span><span class="operator">:</span><span class="number">8</span><span class="paren">]</span><span class="paren">[</span><span class="number">1</span>,<span class="paren">]</span> <span class="operator">/</span> <span class="identifier">total_counts</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>
<span class="identifier">df</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">taxon_rank</span> <span class="operator">=</span> <span class="identifier">query</span>, <span class="identifier">proportions</span><span class="paren">)</span>
<span class="identifier">ggplot</span> <span class="paren">(</span><span class="identifier">data</span><span class="operator">=</span><span class="identifier">df</span>, <span class="identifier">aes</span><span class="paren">(</span><span class="identifier">y</span><span class="operator">=</span><span class="identifier">proportions</span>, <span class="identifier">x</span><span class="operator">=</span><span class="identifier">taxon_rank</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">geom_bar</span><span class="paren">(</span><span class="identifier">stat</span><span class="operator">=</span><span class="string">"identity"</span>, <span class="identifier">fill</span> <span class="operator">=</span> <span class="string">"#8dd3c7"</span>, <span class="identifier">color</span> <span class="operator">=</span> <span class="string">"black"</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">scale_x_discrete</span> <span class="paren">(</span><span class="identifier">limits</span> <span class="operator">=</span> <span class="identifier">query</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">scale_y_continuous</span><span class="paren">(</span><span class="identifier">labels</span> <span class="operator">=</span> <span class="identifier">scales</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">percent</span><span class="paren">)</span></code></pre>
<p><img src="report_files/phylogeny-4.png" width="672"></p>
<pre class="r"><code class="r">  <span class="comment"># Commented out because it used the ID score (which SAP does not have)</span>
      <span class="comment">#vsearch_rank_id &lt;- vsearch_best_match[,c('SCINAME', 'LEVEL')]</span>
      <span class="comment">#sapply (X = vsearch_rank_id$LEVEL, FUN = function (x){ if (!(x %in% taxonomicRanksOfInterest) ){"unranked"}else{x}})</span>
      <span class="comment">#ggplot (data=vsearch_rank_id, aes(y=ID, x=LEVEL)) + geom_boxplot(fill = "#8dd3c7", colour = "black" ) + scale_x_discrete (limits = query)</span></code></pre>
</div>
<div id="section-investigate-identity-scores" class="section level2">
<h2>Investigate identity scores</h2>
<p>BLAST, Vsearch and Ecotag each return an identity score.</p>
<p>The Vsearch parameters specified a minimum identity score of 0.7.</p>
<p>The Ecotag parameters specified a minumum identity score of 0.7.</p>
<p>The BLAST parameters specified a minimum identity score of 0. (????)</p>
<p>The following is intended to see if the assignment methods give 
similar identity scores when assigned to the same reference sequence, as
 well as the overall spread of identity scores.</p>
<pre class="r"><code class="r"><span class="comment"># Ignore SAP</span>

<span class="comment">## Get each assigned OTU with identity score</span>
<span class="identifier">otu_identity_vsearch</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">ovt_vsearch</span><span class="operator">$</span><span class="identifier">OTU_SEQID</span>,
                        <span class="identifier">ovt_vsearch</span><span class="operator">$</span><span class="identifier">VSEARCH_IDENTITY_NT</span> <span class="operator">/</span> <span class="number">100</span>, <span class="identifier">ovt_vsearch</span><span class="operator">$</span><span class="identifier">REF_SEQID</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">otu_identity_vsearch</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"OTU_SEQID"</span>, <span class="string">"VSEARCH_IDENTITY_NT"</span>, <span class="string">"VSEARCH_REF_SEQID"</span><span class="paren">)</span>


<span class="identifier">otu_identity_ecotag</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">ovt_ecotag</span><span class="operator">$</span><span class="identifier">OTU_SEQID</span>, 
                        <span class="identifier">ovt_ecotag</span><span class="operator">$</span><span class="identifier">ECOTAG_IDENTITY_NT</span>, <span class="identifier">ovt_ecotag</span><span class="operator">$</span><span class="identifier">REF_SEQID</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">otu_identity_ecotag</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"OTU_SEQID"</span>, <span class="string">"ECOTAG_IDENTITY_NT"</span>, <span class="string">"ECOTAG_REF_SEQID"</span><span class="paren">)</span>


<span class="identifier">otu_identity_blast</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">ovt_blast</span><span class="operator">$</span><span class="identifier">OTU_SEQID</span>,
                        <span class="identifier">ovt_blast</span><span class="operator">$</span><span class="identifier">BLAST_IDENTITY_NT</span> <span class="operator">/</span> <span class="number">100</span>, <span class="identifier">ovt_blast</span><span class="operator">$</span><span class="identifier">REF_SEQID</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">otu_identity_blast</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"OTU_SEQID"</span>, <span class="string">"BLAST_IDENTITY_NT"</span>, <span class="string">"BLAST_REF_SEQID"</span><span class="paren">)</span>


<span class="comment"># Together such that each OTU has all identity scores</span>
<span class="identifier">otu_identity_EV</span> <span class="operator">&lt;-</span> <span class="identifier">merge</span> <span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">otu_identity_vsearch</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">otu_identity_ecotag</span>, <span class="identifier">by</span> <span class="operator">=</span> <span class="string">"OTU_SEQID"</span><span class="paren">)</span>
<span class="identifier">otu_identity_VB</span> <span class="operator">&lt;-</span> <span class="identifier">merge</span> <span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">otu_identity_vsearch</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">otu_identity_blast</span>, <span class="identifier">by</span> <span class="operator">=</span> <span class="string">"OTU_SEQID"</span><span class="paren">)</span>
<span class="identifier">otu_identity_EB</span> <span class="operator">&lt;-</span> <span class="identifier">merge</span> <span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">otu_identity_ecotag</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">otu_identity_blast</span>, <span class="identifier">by</span> <span class="operator">=</span> <span class="string">"OTU_SEQID"</span><span class="paren">)</span>
<span class="identifier">otu_identity_EVB</span> <span class="operator">&lt;-</span> <span class="identifier">merge</span> <span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">otu_identity_EV</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">otu_identity_blast</span>,  <span class="identifier">by</span> <span class="operator">=</span> <span class="string">"OTU_SEQID"</span><span class="paren">)</span>


<span class="identifier">par</span><span class="paren">(</span><span class="identifier">mfrow</span><span class="operator">=</span><span class="identifier">c</span><span class="paren">(</span><span class="number">1</span>,<span class="number">3</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">plot</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">otu_identity_EV</span><span class="operator">$</span><span class="identifier">VSEARCH_IDENTITY_NT</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">otu_identity_EV</span><span class="operator">$</span><span class="identifier">ECOTAG_IDENTITY_NT</span>,
       <span class="identifier">ylab</span> <span class="operator">=</span> <span class="string">"Ecotag Identity"</span>, <span class="identifier">xlab</span> <span class="operator">=</span> <span class="string">"Vsearch Identity"</span>, <span class="identifier">col</span> <span class="operator">=</span> <span class="string">"black"</span>, <span class="identifier">bg</span> <span class="operator">=</span> <span class="string">"#80b1d3"</span>, <span class="identifier">pch</span><span class="operator">=</span><span class="number">21</span><span class="paren">)</span>
<span class="comment">#abline (lm (otu_identity_EV$VSEARCH_IDENTITY_NT ~ otu_identity_EV$ECOTAG_IDENTITY_NT))</span>
<span class="identifier">text</span><span class="paren">(</span><span class="number">.82</span>, <span class="number">1</span>, <span class="identifier">paste0</span> <span class="paren">(</span><span class="string">"n = "</span>, <span class="identifier">nrow</span> <span class="paren">(</span><span class="identifier">otu_identity_EV</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">cex</span> <span class="operator">=</span> <span class="number">2</span><span class="paren">)</span>

<span class="identifier">plot</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">otu_identity_VB</span><span class="operator">$</span><span class="identifier">VSEARCH_IDENTITY_NT</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">otu_identity_VB</span><span class="operator">$</span><span class="identifier">BLAST_IDENTITY_NT</span>,
       <span class="identifier">ylab</span> <span class="operator">=</span> <span class="string">"Blast Identity"</span>, <span class="identifier">xlab</span> <span class="operator">=</span> <span class="string">"Vsearch Identity"</span>, <span class="identifier">col</span> <span class="operator">=</span> <span class="string">"black"</span>, <span class="identifier">bg</span> <span class="operator">=</span> <span class="string">"#fb8072"</span>, <span class="identifier">pch</span><span class="operator">=</span><span class="number">21</span><span class="paren">)</span>
<span class="comment">#abline (lm (otu_identity_VB$VSEARCH_IDENTITY_NT ~ otu_identity_VB$BLAST_IDENTITY_NT))</span>
<span class="identifier">text</span><span class="paren">(</span><span class="number">.82</span>, <span class="number">1</span>, <span class="identifier">paste0</span> <span class="paren">(</span><span class="string">"n = "</span>, <span class="identifier">nrow</span> <span class="paren">(</span><span class="identifier">otu_identity_VB</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">cex</span> <span class="operator">=</span> <span class="number">2</span><span class="paren">)</span>

<span class="identifier">plot</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">otu_identity_EB</span><span class="operator">$</span><span class="identifier">BLAST_IDENTITY_NT</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">otu_identity_EB</span><span class="operator">$</span><span class="identifier">ECOTAG_IDENTITY_NT</span>,
       <span class="identifier">ylab</span> <span class="operator">=</span> <span class="string">"Ecotag Identity"</span>, <span class="identifier">xlab</span> <span class="operator">=</span> <span class="string">"Blast Identity"</span>, <span class="identifier">col</span> <span class="operator">=</span> <span class="string">"black"</span>, <span class="identifier">bg</span> <span class="operator">=</span> <span class="string">"#fdb462"</span>, <span class="identifier">pch</span><span class="operator">=</span><span class="number">21</span><span class="paren">)</span>
<span class="comment">#abline (lm (otu_identity_EB$BLAST_IDENTITY_NT ~ otu_identity_EB$ECOTAG_IDENTITY_NT))</span>
<span class="identifier">text</span><span class="paren">(</span><span class="number">.84</span>, <span class="number">1</span>, <span class="identifier">paste0</span> <span class="paren">(</span><span class="string">"n = "</span>, <span class="identifier">nrow</span> <span class="paren">(</span><span class="identifier">otu_identity_EB</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">cex</span> <span class="operator">=</span> <span class="number">2</span><span class="paren">)</span>
<span class="identifier">title</span><span class="paren">(</span><span class="string">"Identity Scores between assignments from same OTU"</span>, <span class="identifier">outer</span><span class="operator">=</span><span class="literal">TRUE</span>, <span class="identifier">line</span> <span class="operator">=</span> <span class="operator">-</span><span class="number">3</span><span class="paren">)</span></code></pre>
<p><img src="report_files/identity_scores-1.png" width="672"></p>
<p><em>2-sample t-test between Ecotag Identity and Vsearch Identity for same OTUs</em></p>
<pre class="r"><code class="r"><span class="identifier">var.test</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">otu_identity_EV</span><span class="operator">$</span><span class="identifier">VSEARCH_IDENTITY_NT</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">otu_identity_EV</span><span class="operator">$</span><span class="identifier">ECOTAG_IDENTITY_NT</span><span class="paren">)</span></code></pre>
<pre><code>## 
##  F test to compare two variances
## 
## data:  otu_identity_EV$VSEARCH_IDENTITY_NT and otu_identity_EV$ECOTAG_IDENTITY_NT
## F = 3.8333, num df = 467, denom df = 467, p-value &lt; 2.2e-16
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  3.196666 4.596691
## sample estimates:
## ratio of variances 
##           3.833286</code></pre>
<pre class="r"><code class="r"><span class="identifier">t.test</span><span class="paren">(</span><span class="identifier">otu_identity_EV</span><span class="operator">$</span><span class="identifier">VSEARCH_IDENTITY_NT</span>, <span class="identifier">otu_identity_EV</span><span class="operator">$</span><span class="identifier">ECOTAG_IDENTITY_NT</span>, <span class="identifier">var.equal</span><span class="operator">=</span><span class="literal">FALSE</span>, <span class="identifier">paired</span><span class="operator">=</span><span class="literal">TRUE</span>, <span class="identifier">alternative</span> <span class="operator">=</span> <span class="string">"two.sided"</span><span class="paren">)</span></code></pre>
<pre><code>## 
##  Paired t-test
## 
## data:  otu_identity_EV$VSEARCH_IDENTITY_NT and otu_identity_EV$ECOTAG_IDENTITY_NT
## t = 2.5563, df = 467, p-value = 0.01089
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.002791707 0.021347716
## sample estimates:
## mean of the differences 
##              0.01206971</code></pre>
<p><em>2-sample t-test between Blast Identity and Vsearch Identity for same OTUs</em></p>
<pre class="r"><code class="r"><span class="identifier">var.test</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">otu_identity_VB</span><span class="operator">$</span><span class="identifier">VSEARCH_IDENTITY_NT</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">otu_identity_VB</span><span class="operator">$</span><span class="identifier">BLAST_IDENTITY_NT</span><span class="paren">)</span></code></pre>
<pre><code>## 
##  F test to compare two variances
## 
## data:  otu_identity_VB$VSEARCH_IDENTITY_NT and otu_identity_VB$BLAST_IDENTITY_NT
## F = 3.1397, num df = 461, denom df = 461, p-value &lt; 2.2e-16
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  2.615145 3.769378
## sample estimates:
## ratio of variances 
##           3.139661</code></pre>
<pre class="r"><code class="r"><span class="identifier">t.test</span><span class="paren">(</span><span class="identifier">otu_identity_VB</span><span class="operator">$</span><span class="identifier">VSEARCH_IDENTITY_NT</span>, <span class="identifier">otu_identity_VB</span><span class="operator">$</span><span class="identifier">BLAST_IDENTITY_NT</span>, <span class="identifier">var.equal</span><span class="operator">=</span><span class="literal">FALSE</span>, <span class="identifier">paired</span><span class="operator">=</span><span class="literal">TRUE</span>, <span class="identifier">alternative</span> <span class="operator">=</span> <span class="string">"two.sided"</span><span class="paren">)</span></code></pre>
<pre><code>## 
##  Paired t-test
## 
## data:  otu_identity_VB$VSEARCH_IDENTITY_NT and otu_identity_VB$BLAST_IDENTITY_NT
## t = -16.557, df = 461, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.05416972 -0.04267530
## sample estimates:
## mean of the differences 
##             -0.04842251</code></pre>
<p><em>2-sample t-test between Ecotag Identity and Ecotag Identity for same OTUs</em></p>
<pre class="r"><code class="r"><span class="identifier">var.test</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">otu_identity_EB</span><span class="operator">$</span><span class="identifier">BLAST_IDENTITY_NT</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">otu_identity_EB</span><span class="operator">$</span><span class="identifier">ECOTAG_IDENTITY_NT</span><span class="paren">)</span></code></pre>
<pre><code>## 
##  F test to compare two variances
## 
## data:  otu_identity_EB$BLAST_IDENTITY_NT and otu_identity_EB$ECOTAG_IDENTITY_NT
## F = 1.5597, num df = 805, denom df = 805, p-value = 3.433e-10
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  1.358281 1.790929
## sample estimates:
## ratio of variances 
##           1.559675</code></pre>
<pre class="r"><code class="r"><span class="identifier">t.test</span><span class="paren">(</span><span class="identifier">otu_identity_EB</span><span class="operator">$</span><span class="identifier">BLAST_IDENTITY_NT</span>, <span class="identifier">otu_identity_EB</span><span class="operator">$</span><span class="identifier">ECOTAG_IDENTITY_NT</span>, <span class="identifier">var.equal</span><span class="operator">=</span><span class="literal">FALSE</span>, <span class="identifier">paired</span><span class="operator">=</span><span class="literal">TRUE</span>, <span class="identifier">alternative</span> <span class="operator">=</span> <span class="string">"two.sided"</span><span class="paren">)</span></code></pre>
<pre><code>## 
##  Paired t-test
## 
## data:  otu_identity_EB$BLAST_IDENTITY_NT and otu_identity_EB$ECOTAG_IDENTITY_NT
## t = 23.581, df = 805, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.04290550 0.05069695
## sample estimates:
## mean of the differences 
##              0.04680122</code></pre>
<hr>
</div>
<div id="section-how-similar-are-the-score-for-when-two-methods-reach-the-same-assignment-for-an-otu" class="section level2">
<h2>How similar are the score for when two methods reach the same assignment for an OTU?</h2>
<pre class="r"><code class="r"><span class="identifier">otu_EV_same_refseq</span> <span class="operator">&lt;-</span> <span class="identifier">otu_identity_EV</span><span class="paren">[</span><span class="identifier">as.character</span> <span class="paren">(</span><span class="identifier">otu_identity_EV</span><span class="operator">$</span><span class="identifier">VSEARCH_REF_SEQID</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">as.character</span> <span class="paren">(</span><span class="identifier">otu_identity_EV</span><span class="operator">$</span><span class="identifier">ECOTAG_REF_SEQID</span><span class="paren">)</span>,<span class="paren">]</span>
<span class="identifier">otu_EV_same_refseq</span> <span class="operator">&lt;-</span> <span class="identifier">otu_EV_same_refseq</span><span class="paren">[</span><span class="identifier">complete.cases</span><span class="paren">(</span><span class="identifier">otu_EV_same_refseq</span><span class="paren">)</span>,<span class="paren">]</span>
<span class="identifier">num_same_ref_seq_EV</span> <span class="operator">&lt;-</span> <span class="identifier">nrow</span> <span class="paren">(</span><span class="identifier">otu_EV_same_refseq</span><span class="paren">)</span>

<span class="identifier">otu_VB_same_refseq</span> <span class="operator">&lt;-</span> <span class="identifier">otu_identity_VB</span><span class="paren">[</span> <span class="identifier">as.character</span> <span class="paren">(</span><span class="identifier">otu_identity_VB</span><span class="operator">$</span><span class="identifier">VSEARCH_REF_SEQID</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">as.character</span> <span class="paren">(</span><span class="identifier">otu_identity_VB</span><span class="operator">$</span><span class="identifier">BLAST_REF_SEQID</span><span class="paren">)</span>,<span class="paren">]</span>
<span class="identifier">otu_VB_same_refseq</span> <span class="operator">&lt;-</span> <span class="identifier">otu_VB_same_refseq</span><span class="paren">[</span><span class="identifier">complete.cases</span><span class="paren">(</span><span class="identifier">otu_VB_same_refseq</span><span class="paren">)</span>,<span class="paren">]</span>
<span class="identifier">num_same_ref_seq_VB</span> <span class="operator">&lt;-</span> <span class="identifier">nrow</span> <span class="paren">(</span><span class="identifier">otu_VB_same_refseq</span><span class="paren">)</span>

<span class="identifier">otu_EB_same_refseq</span> <span class="operator">&lt;-</span> <span class="identifier">otu_identity_EB</span><span class="paren">[</span> <span class="identifier">as.character</span> <span class="paren">(</span><span class="identifier">otu_identity_EB</span><span class="operator">$</span><span class="identifier">ECOTAG_REF_SEQID</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">as.character</span> <span class="paren">(</span><span class="identifier">otu_identity_EB</span><span class="operator">$</span><span class="identifier">BLAST_REF_SEQID</span><span class="paren">)</span>,<span class="paren">]</span>
<span class="identifier">otu_EB_same_refseq</span> <span class="operator">&lt;-</span> <span class="identifier">otu_EB_same_refseq</span><span class="paren">[</span><span class="identifier">complete.cases</span><span class="paren">(</span><span class="identifier">otu_EB_same_refseq</span><span class="paren">)</span>,<span class="paren">]</span>
<span class="identifier">num_same_ref_seq_EB</span> <span class="operator">&lt;-</span> <span class="identifier">nrow</span> <span class="paren">(</span><span class="identifier">otu_EB_same_refseq</span><span class="paren">)</span></code></pre>
<p>Vsearch and Ecotag share 31 assignments to the same reference sequence.</p>
<p>Vsearch and Blast share 167 assignments to the same reference sequence.</p>
<p>Ecotag and Blast share 62 assignments to the same reference sequence.</p>
<pre class="r"><code class="r"><span class="identifier">par</span><span class="paren">(</span><span class="identifier">mfrow</span><span class="operator">=</span><span class="identifier">c</span><span class="paren">(</span><span class="number">1</span>,<span class="number">3</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">plot</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">otu_EV_same_refseq</span><span class="operator">$</span><span class="identifier">VSEARCH_IDENTITY_NT</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">otu_EV_same_refseq</span><span class="operator">$</span><span class="identifier">ECOTAG_IDENTITY_NT</span>,
       <span class="identifier">ylab</span> <span class="operator">=</span> <span class="string">"Ecotag Identity"</span>, <span class="identifier">xlab</span> <span class="operator">=</span> <span class="string">"Vsearch Identity"</span>, <span class="identifier">col</span> <span class="operator">=</span> <span class="string">"black"</span>, <span class="identifier">bg</span> <span class="operator">=</span> <span class="string">"#80b1d3"</span>, <span class="identifier">pch</span><span class="operator">=</span><span class="number">21</span><span class="paren">)</span>
<span class="identifier">text</span><span class="paren">(</span><span class="number">.86</span>, <span class="number">1</span>, <span class="identifier">paste0</span> <span class="paren">(</span><span class="string">"n = "</span>, <span class="identifier">nrow</span> <span class="paren">(</span><span class="identifier">otu_EV_same_refseq</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">cex</span> <span class="operator">=</span> <span class="number">2</span><span class="paren">)</span>

<span class="identifier">plot</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">otu_VB_same_refseq</span><span class="operator">$</span><span class="identifier">VSEARCH_IDENTITY_NT</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">otu_VB_same_refseq</span><span class="operator">$</span><span class="identifier">BLAST_IDENTITY_NT</span>,
       <span class="identifier">ylab</span> <span class="operator">=</span> <span class="string">"Blast Identity"</span>, <span class="identifier">xlab</span> <span class="operator">=</span> <span class="string">"Vsearch Identity"</span>, <span class="identifier">col</span> <span class="operator">=</span> <span class="string">"black"</span>, <span class="identifier">bg</span> <span class="operator">=</span> <span class="string">"#fb8072"</span>, <span class="identifier">pch</span> <span class="operator">=</span> <span class="number">21</span><span class="paren">)</span>
<span class="identifier">text</span><span class="paren">(</span><span class="number">.85</span>, <span class="number">1</span>, <span class="identifier">paste0</span> <span class="paren">(</span><span class="string">"n = "</span>, <span class="identifier">nrow</span> <span class="paren">(</span><span class="identifier">otu_VB_same_refseq</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">cex</span> <span class="operator">=</span> <span class="number">2</span><span class="paren">)</span>

<span class="identifier">plot</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">otu_EB_same_refseq</span><span class="operator">$</span><span class="identifier">BLAST_IDENTITY_NT</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">otu_EB_same_refseq</span><span class="operator">$</span><span class="identifier">ECOTAG_IDENTITY_NT</span>,
       <span class="identifier">ylab</span> <span class="operator">=</span> <span class="string">"Ecotag Identity"</span>, <span class="identifier">xlab</span> <span class="operator">=</span> <span class="string">"Blast Identity"</span>, <span class="identifier">col</span> <span class="operator">=</span> <span class="string">"black"</span>, <span class="identifier">bg</span> <span class="operator">=</span> <span class="string">"#fdb462"</span>, <span class="identifier">pch</span> <span class="operator">=</span> <span class="number">21</span><span class="paren">)</span> 
<span class="identifier">text</span><span class="paren">(</span><span class="number">.87</span>, <span class="number">1</span>, <span class="identifier">paste0</span> <span class="paren">(</span><span class="string">"n = "</span>, <span class="identifier">nrow</span> <span class="paren">(</span><span class="identifier">otu_EB_same_refseq</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">cex</span> <span class="operator">=</span> <span class="number">2</span><span class="paren">)</span>

<span class="identifier">title</span><span class="paren">(</span><span class="string">"Identity Scores when OTU is assigned to same reference sequence"</span>, <span class="identifier">outer</span><span class="operator">=</span><span class="literal">TRUE</span>, <span class="identifier">line</span> <span class="operator">=</span> <span class="operator">-</span><span class="number">3</span><span class="paren">)</span></code></pre>
<p><img src="report_files/unnamed-chunk-5-1.png" width="672"></p>
<p><em>2-sample t-test between Ecotag Identity and Vsearch Identity for matched reference sequence</em></p>
<pre class="r"><code class="r"><span class="identifier">var.test</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">otu_EV_same_refseq</span><span class="operator">$</span><span class="identifier">VSEARCH_IDENTITY_NT</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">otu_EV_same_refseq</span><span class="operator">$</span><span class="identifier">ECOTAG_IDENTITY_NT</span><span class="paren">)</span></code></pre>
<pre><code>## 
##  F test to compare two variances
## 
## data:  otu_EV_same_refseq$VSEARCH_IDENTITY_NT and otu_EV_same_refseq$ECOTAG_IDENTITY_NT
## F = 1.0251, num df = 30, denom df = 30, p-value = 0.9463
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  0.4942798 2.1260173
## sample estimates:
## ratio of variances 
##           1.025108</code></pre>
<pre class="r"><code class="r"><span class="identifier">t.test</span><span class="paren">(</span><span class="identifier">otu_EV_same_refseq</span><span class="operator">$</span><span class="identifier">VSEARCH_IDENTITY_NT</span>, <span class="identifier">otu_EV_same_refseq</span><span class="operator">$</span><span class="identifier">ECOTAG_IDENTITY_NT</span>, <span class="identifier">var.equal</span><span class="operator">=</span><span class="literal">TRUE</span>, <span class="identifier">paired</span><span class="operator">=</span><span class="literal">TRUE</span>, <span class="identifier">alternative</span> <span class="operator">=</span> <span class="string">"two.sided"</span><span class="paren">)</span></code></pre>
<pre><code>## 
##  Paired t-test
## 
## data:  otu_EV_same_refseq$VSEARCH_IDENTITY_NT and otu_EV_same_refseq$ECOTAG_IDENTITY_NT
## t = 1.7992, df = 30, p-value = 0.08206
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.0001225181  0.0019358746
## sample estimates:
## mean of the differences 
##            0.0009066782</code></pre>
<p><em>2-sample t-test between Blast Identity and Vsearch Identity for matched reference sequence</em></p>
<pre class="r"><code class="r"><span class="identifier">var.test</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">otu_VB_same_refseq</span><span class="operator">$</span><span class="identifier">VSEARCH_IDENTITY_NT</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">otu_VB_same_refseq</span><span class="operator">$</span><span class="identifier">BLAST_IDENTITY_NT</span><span class="paren">)</span></code></pre>
<pre><code>## 
##  F test to compare two variances
## 
## data:  otu_VB_same_refseq$VSEARCH_IDENTITY_NT and otu_VB_same_refseq$BLAST_IDENTITY_NT
## F = 1.3837, num df = 166, denom df = 166, p-value = 0.03713
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  1.019640 1.877676
## sample estimates:
## ratio of variances 
##           1.383674</code></pre>
<pre class="r"><code class="r"><span class="identifier">t.test</span><span class="paren">(</span><span class="identifier">otu_VB_same_refseq</span><span class="operator">$</span><span class="identifier">VSEARCH_IDENTITY_NT</span>, <span class="identifier">otu_VB_same_refseq</span><span class="operator">$</span><span class="identifier">BLAST_IDENTITY_NT</span> , <span class="identifier">var.equal</span><span class="operator">=</span><span class="literal">FALSE</span>, <span class="identifier">paired</span><span class="operator">=</span><span class="literal">TRUE</span>, <span class="identifier">alternative</span> <span class="operator">=</span> <span class="string">"two.sided"</span><span class="paren">)</span></code></pre>
<pre><code>## 
##  Paired t-test
## 
## data:  otu_VB_same_refseq$VSEARCH_IDENTITY_NT and otu_VB_same_refseq$BLAST_IDENTITY_NT
## t = -4.0501, df = 166, p-value = 7.843e-05
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.007313617 -0.002519916
## sample estimates:
## mean of the differences 
##            -0.004916766</code></pre>
<p><em>2-sample t-test between Ecotag Identity and Ecotag Identity for matched reference sequence</em></p>
<pre class="r"><code class="r"><span class="identifier">var.test</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">otu_EB_same_refseq</span><span class="operator">$</span><span class="identifier">BLAST_IDENTITY_NT</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">otu_EB_same_refseq</span><span class="operator">$</span><span class="identifier">ECOTAG_IDENTITY_NT</span><span class="paren">)</span></code></pre>
<pre><code>## 
##  F test to compare two variances
## 
## data:  otu_EB_same_refseq$BLAST_IDENTITY_NT and otu_EB_same_refseq$ECOTAG_IDENTITY_NT
## F = 0.87275, num df = 61, denom df = 61, p-value = 0.5967
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  0.5258594 1.4484737
## sample estimates:
## ratio of variances 
##          0.8727505</code></pre>
<pre class="r"><code class="r"><span class="identifier">t.test</span><span class="paren">(</span><span class="identifier">otu_EB_same_refseq</span><span class="operator">$</span><span class="identifier">BLAST_IDENTITY_NT</span> , <span class="identifier">otu_EB_same_refseq</span><span class="operator">$</span><span class="identifier">ECOTAG_IDENTITY_NT</span>, <span class="identifier">var.equal</span><span class="operator">=</span><span class="literal">TRUE</span>, <span class="identifier">paired</span><span class="operator">=</span><span class="literal">TRUE</span>, <span class="identifier">alternative</span> <span class="operator">=</span> <span class="string">"two.sided"</span><span class="paren">)</span></code></pre>
<pre><code>## 
##  Paired t-test
## 
## data:  otu_EB_same_refseq$BLAST_IDENTITY_NT and otu_EB_same_refseq$ECOTAG_IDENTITY_NT
## t = 6.5373, df = 61, p-value = 1.437e-08
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.005149671 0.009688283
## sample estimates:
## mean of the differences 
##             0.007418977</code></pre>
</div>
<div id="section-investigate-taxonomy-before-97-filter" class="section level2">
<h2>Investigate Taxonomy (Before 97% filter)</h2>
<pre><code>##      Source    species genus family order class phylum kingdom
## [1,] "Vsearch" "253"   "206" "149"  "87"  "34"  "21"   "4"    
## [2,] "Ecotag"  "103"   "120" "119"  "79"  "38"  "22"   "4"    
## [3,] "Blast"   "583"   "439" "326"  "143" "53"  "27"   "4"    
## [4,] "SAP"     "55"    "79"  "66"   "41"  "19"  "9"    "3"</code></pre>
<pre><code>##         Ecotag, Vsearch Ecotag, Blast Ecotag, SAP Vsearch, Blast
## species              41            49          17            159
## genus                65            78          35            151
## family               66            88          44            106
## order                45            65          32             69
## class                25            32          18             30
## phylum               14            20           9             17
## kingdom               4             4           3              4
##         Vsearch, SAP Blast, SAP Ecotag, Vsearch, Blast
## species           50         52                     36
## genus             76         78                     62
## family            63         66                     64
## order             40         40                     44
## class             18         18                     25
## phylum             9          9                     14
## kingdom            3          3                      4
##         Ecotag, Vsearch, SAP Vsearch, Blast, SAP
## species                   17                  49
## genus                     35                  76
## family                    43                  63
## order                     32                  40
## class                     18                  18
## phylum                     9                   9
## kingdom                    3                   3
##         Ecotag, Vsearch, Blast, SAP
## species                          16
## genus                            35
## family                           43
## order                            32
## class                            18
## phylum                            9
## kingdom                           3</code></pre>
<pre><code>##      Source    species genus family order class phylum kingdom
## [1,] "Vsearch" "253"   "206" "149"  "87"  "34"  "21"   "4"    
## [2,] "Ecotag"  "103"   "120" "119"  "79"  "38"  "22"   "4"    
## [3,] "Blast"   "583"   "439" "326"  "143" "53"  "27"   "4"    
## [4,] "SAP"     "55"    "79"  "66"   "41"  "19"  "9"    "3"</code></pre>
<pre><code>## [1] "Unique class counts (no filter)"</code></pre>
<pre><code>##        Malacostraca     Sordariomycetes        Phaeophyceae 
##                  37                  18                  17 
##  Microbotryomycetes         Actinopteri                     
##                   5                 185                  45 
##         Maxillopoda         Cephalopoda       Chrysophyceae 
##                  11                   9                  23 
##   Bacillariophyceae            Mammalia     Mamiellophyceae 
##                  12                  15                   7 
##     Dothideomycetes    Bicosoecophyceae            Amphibia 
##                  19                   6                   3 
##       Leotiomycetes      Chondrichthyes      Eurotiomycetes 
##                   9                   8                   6 
##         Sagittoidea   Malasseziomycetes          Gastropoda 
##                   2                   2                   5 
##           Oomycetes                Aves           Ostracoda 
##                   1                   5                   1 
##             Insecta      Raphidophyceae         Dinophyceae 
##                   3                   5                   1 
##     Saccharomycetes    Prymnesiophyceae            Reptilia 
##                   2                   1                   1 
## Blastocladiomycetes         Ophiuroidea            Hydrozoa 
##                   1                   1                   2 
## Coscinodiscophyceae 
##                   1</code></pre>
<pre><code>##         Chromadorea                            Malacostraca 
##                   7                 421                  75 
##         Sagittoidea         Conoidasida  Microbotryomycetes 
##                   5                   4                   3 
##         Actinopteri         Maxillopoda          Polychaeta 
##                 149                  16                  13 
##             Cestoda            Mammalia      Agaricomycetes 
##                  15                   8                   3 
##            Bivalvia       Enteropneusta     Saccharomycetes 
##                   3                   1                   3 
##         Cephalopoda            Hydrozoa          Gastropoda 
##                   8                  10                  12 
##      Eurotiomycetes     Sordariomycetes           Oomycetes 
##                   5                  12                   3 
##           Ostracoda             Insecta      Chondrichthyes 
##                   2                   6                   7 
##             Enoplea         Tentaculata   Bacillariophyceae 
##                   3                   2                   3 
##     Dothideomycetes         Dinophyceae    Prymnesiophyceae 
##                   4                   2                   1 
##                Aves Coscinodiscophyceae         Ophiuroidea 
##                   1                   5                   1 
## Chlorodendrophyceae              Enopla              Anopla 
##                   1                   1                   2 
##         Turbellaria       Leotiomycetes 
##                   1                   1</code></pre>
<pre><code>##         Chromadorea         Turbellaria        Malacostraca 
##                   7                   2                 198 
##         Sagittoidea            Coccidia     Sordariomycetes 
##                   4                   4                  19 
##          Gastropoda             Insecta         Actinopteri 
##                  18                  91                 233 
##      Palaeonemertea         Maxillopoda           Arachnida 
##                   4                  19                  16 
##            Hydrozoa             Cestoda              Anopla 
##                  11                  12                   3 
##          Polychaeta            Mammalia         Cephalopoda 
##                  32                  13                  15 
##      Prasinophyceae      Agaricomycetes       Onychophorida 
##                   1                   4                   1 
##       Leotiomycetes            Bivalvia                     
##                  10                   3                  17 
##        Phaeophyceae      Eurotiomycetes          Clitellata 
##                   5                  10                   3 
##     Saccharomycetes           Oomycetes          Collembola 
##                   3                   2                   1 
##            Reptilia      Raphidophyceae           Ostracoda 
##                   2                   1                   1 
##      Chondrichthyes                Nuda   Bacillariophyceae 
##                   7                   1                   4 
##           Trematoda     Dothideomycetes           Scyphozoa 
##                   5                   5                   1 
##             Protura       Chrysophyceae         Dinophyceae 
##                   1                   1                   1 
##     Lecanoromycetes    Prymnesiophyceae                Aves 
##                   1                   1                   2 
##    Trebouxiophyceae Coscinodiscophyceae            Amphibia 
##                   1                   5                   1 
##         Ophiuroidea          Bdelloidea         Zygomycetes 
##                   1                   1                   1 
##  Microbotryomycetes        Gymnolaemata 
##                   1                   1</code></pre>
<pre><code>##      Actinopteri   Chondrichthyes                      Malacostraca 
##               64                3               28               18 
##  Sordariomycetes       Gastropoda   Eurotiomycetes         Mammalia 
##                4                4                2                5 
##      Sagittoidea      Cephalopoda      Ophiuroidea  Dothideomycetes 
##                2                6                1                1 
##      Maxillopoda          Insecta             Aves         Oomycota 
##                9                3                1                1 
##        Ostracoda Prymnesiophyceae         Hydrozoa 
##                1                1                1</code></pre>
<pre><code>## [1] "Unique phylum counts (no filter)"</code></pre>
<pre><code>##         Arthropoda         Ascomycota       Phaeophyceae 
##                 52                 54                 17 
##      Basidiomycota           Chordata Eukarya_unassigned 
##                  7                218                  5 
##  Eustigmatophyceae           Mollusca    Bacillariophyta 
##                 45                 14                 10 
##        Chlorophyta   Heterokontophyta                    
##                  7                  7                  8 
##       Chaetognatha           Placozoa         Ochrophyta 
##                  2                  6                  8 
##    Pyrrophycophyta          Amoebozoa         Haptophyta 
##                  1                  3                  1 
## Blastocladiomycota      Echinodermata           Cnidaria 
##                  1                  1                  2</code></pre>
<pre><code>##         Nematoda  Platyhelminthes       Arthropoda     Chaetognatha 
##               10               19              190                5 
##      Apicomplexa       Ascomycota                     Basidiomycota 
##                4               35              251                6 
##         Chordata         Annelida         Mollusca     Hemichordata 
##              221               24               23                1 
##         Cnidaria Heterokontophyta       Ctenophora  Bacillariophyta 
##               10                1                2                8 
##  Pyrrophycophyta       Haptophyta         Nemertea    Echinodermata 
##                1                1                4                1 
##      Chlorophyta     Mucoromycota 
##                1                1</code></pre>
<pre><code>##          Nematoda   Platyhelminthes        Arthropoda      Chaetognatha 
##                 7                19               330                 4 
##       Apicomplexa        Ascomycota          Mollusca          Chordata 
##                 4                48                36               264 
##          Nemertea          Cnidaria          Annelida       Chlorophyta 
##                 8                12                37                 2 
##     Basidiomycota       Onychophora      Phaeophyceae                   
##                 5                 1                 5                 5 
##        Ochrophyta  Heterokontophyta        Ctenophora   Bacillariophyta 
##                 1                 1                 2                 9 
## Eustigmatophyceae   Pyrrophycophyta        Haptophyta     Echinodermata 
##                 1                 1                 1                 1 
##          Rotifera        Zygomycota           Bryozoa 
##                 1                 1                 1</code></pre>
<pre><code>##         Chordata         Mollusca       Arthropoda       Ascomycota 
##               96               11               33                9 
##     Chaetognatha    Echinodermata Heterokontophyta       Haptophyta 
##                2                1                1                1 
##         Cnidaria 
##                1</code></pre>
<pre><code>## [1] "Unique kingdom counts (no filter)"</code></pre>
<pre><code>##       Metazoa         Fungi               Viridiplantae 
##           295            62           105             7</code></pre>
<pre><code>##       Metazoa                       Fungi Viridiplantae 
##           697            79            42             1</code></pre>
<pre><code>##       Metazoa                       Fungi Viridiplantae 
##           725            26            54             2</code></pre>
<pre><code>## Metazoa   Fungi         
##     144       9       2</code></pre>
<div id="section-phylum-80-identity-filter" class="section level3">
<h3>Phylum: 80% identity filter</h3>
<pre class="r"><code class="r"><span class="comment"># SAP complete </span>

<span class="identifier">taxonomicRanksOfInterest</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"species"</span>, <span class="string">"genus"</span>, <span class="string">"family"</span>, <span class="string">"order"</span>, <span class="string">"class"</span>, <span class="string">"phylum"</span>, <span class="string">"kingdom"</span><span class="paren">)</span>

<span class="comment"># Vsearch</span>
<span class="identifier">ovt_vsearch_80</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_vsearch</span><span class="paren">[</span><span class="identifier">ovt_vsearch</span><span class="operator">$</span><span class="identifier">VSEARCH_IDENTITY_NT</span> <span class="operator">&gt;=</span> <span class="number">80</span>,<span class="paren">]</span>

<span class="identifier">vsearch_taxonomy</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_vsearch_80</span><span class="paren">[</span>,<span class="identifier">taxonomicRanksOfInterest</span><span class="paren">]</span>
<span class="identifier">vsearch_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">vsearch_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">vsearch_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">vsearch_best_match_scinames</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">vsearch_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">vsearch_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">vsearch_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">vsearch_best_match_levels</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">vsearch_best_match</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">ovt_vsearch_80</span><span class="operator">$</span><span class="identifier">OTU_SEQID</span>, 
                                        <span class="identifier">vsearch_best_match_scinames</span>, <span class="identifier">vsearch_best_match_levels</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">vsearch_best_match</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"OTU_SEQID"</span>, <span class="string">"SCINAME"</span>, <span class="string">"LEVEL"</span><span class="paren">)</span>


<span class="comment"># Ecotag - Ignore the filter since it should be "smart"</span>
<span class="identifier">ovt_ecotag_80</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_ecotag</span>

<span class="identifier">ecotag_taxonomy</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_ecotag_80</span><span class="paren">[</span>,<span class="identifier">taxonomicRanksOfInterest</span><span class="paren">]</span>
<span class="identifier">ecotag_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">ecotag_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">ecotag_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">ecotag_best_match_scinames</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">ecotag_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">ecotag_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">ecotag_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">ecotag_best_match_levels</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">ecotag_best_match</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">ovt_ecotag_80</span><span class="operator">$</span><span class="identifier">OTU_SEQID</span>, 
                                        <span class="identifier">ecotag_best_match_scinames</span>, <span class="identifier">ecotag_best_match_levels</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ecotag_best_match</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"OTU_SEQID"</span>, <span class="string">"SCINAME"</span>, <span class="string">"LEVEL"</span><span class="paren">)</span>


<span class="comment"># Blast</span>
<span class="identifier">ovt_blast_80</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_blast</span><span class="paren">[</span><span class="identifier">ovt_blast</span><span class="operator">$</span><span class="identifier">BLAST_IDENTITY_NT</span> <span class="operator">&gt;=</span> <span class="number">80</span>,<span class="paren">]</span>

<span class="identifier">blast_taxonomy</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_blast_80</span><span class="paren">[</span>,<span class="identifier">taxonomicRanksOfInterest</span><span class="paren">]</span>
<span class="identifier">blast_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">blast_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">blast_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">blast_best_match_scinames</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">blast_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">blast_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">blast_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">blast_best_match_levels</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">blast_best_match</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">ovt_blast_80</span><span class="operator">$</span><span class="identifier">OTU_SEQID</span>, 
                                        <span class="identifier">blast_best_match_scinames</span>, <span class="identifier">blast_best_match_levels</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">blast_best_match</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"OTU_SEQID"</span>, <span class="string">"SCINAME"</span>, <span class="string">"LEVEL"</span><span class="paren">)</span>


<span class="comment"># SAP - Ignore the filter since it should be "smart"</span>
<span class="identifier">ovt_sap_80</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_sap</span>

<span class="identifier">sap_taxonomy</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_sap_80</span><span class="paren">[</span>,<span class="identifier">taxonomicRanksOfInterest</span><span class="paren">]</span>
<span class="identifier">sap_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">sap_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">sap_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">sap_best_match_scinames</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">sap_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">sap_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">sap_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">sap_best_match_levels</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">sap_best_match</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">ovt_sap_80</span><span class="operator">$</span><span class="identifier">OTU_SEQID</span>, 
                                        <span class="identifier">sap_best_match_scinames</span>, <span class="identifier">sap_best_match_levels</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">sap_best_match</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"OTU_SEQID"</span>, <span class="string">"SCINAME"</span>, <span class="string">"LEVEL"</span><span class="paren">)</span>



<span class="identifier">taxon_level_counts_vsearch</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">taxonomicRanksOfInterest</span>, 
                                      <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">vsearch_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">taxon_level_counts_ecotag</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">taxonomicRanksOfInterest</span>, 
                                     <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">ecotag_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">taxon_level_counts_blast</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">taxonomicRanksOfInterest</span>, 
                                     <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">blast_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">taxon_level_counts_sap</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">taxonomicRanksOfInterest</span>, 
                                     <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">sap_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">empty_taxon_count_vsearch</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">vsearch_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="string">""</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">empty_taxon_count_ecotag</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">ecotag_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="string">""</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">empty_taxon_count_blast</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">blast_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="string">""</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">empty_taxon_count_sap</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">sap_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="string">""</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">empty_counts</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="identifier">empty_taxon_count_vsearch</span>, <span class="identifier">empty_taxon_count_ecotag</span>, <span class="identifier">empty_taxon_count_blast</span>, <span class="identifier">empty_taxon_count_sap</span><span class="paren">)</span>


<span class="identifier">total_count_vsearch</span> <span class="operator">&lt;-</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">taxon_level_counts_vsearch</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">empty_taxon_count_vsearch</span>
<span class="identifier">total_count_ecotag</span> <span class="operator">&lt;-</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">taxon_level_counts_ecotag</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">empty_taxon_count_ecotag</span>
<span class="identifier">total_count_blast</span> <span class="operator">&lt;-</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">taxon_level_counts_blast</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">empty_taxon_count_blast</span>

<span class="identifier">total_counts_80</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="identifier">total_count_vsearch</span>, <span class="identifier">total_count_ecotag</span>, <span class="identifier">total_count_blast</span>, <span class="identifier">total_count_sap</span><span class="paren">)</span>
   

<span class="comment"># ASSERTION: total_counts should equal the nrow (ovt_XXX_80)</span>
    
<span class="identifier">titles_col</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"Vsearch"</span>, <span class="string">"Ecotag"</span>, <span class="string">"Blast"</span>, <span class="string">"SAP"</span><span class="paren">)</span>
<span class="identifier">counts_table</span> <span class="operator">&lt;-</span> <span class="identifier">rbind.data.frame</span> <span class="paren">(</span><span class="identifier">taxon_level_counts_vsearch</span>, <span class="identifier">taxon_level_counts_ecotag</span>, <span class="identifier">taxon_level_counts_blast</span>, <span class="identifier">taxon_level_counts_sap</span><span class="paren">)</span>
<span class="identifier">counts_table</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span><span class="paren">(</span><span class="identifier">titles_col</span>, <span class="identifier">counts_table</span>, <span class="identifier">empty_counts</span>, <span class="identifier">total_counts_80</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">counts_table</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"Source"</span>, <span class="identifier">taxonomicRanksOfInterest</span>, <span class="string">"unassigned"</span>, <span class="string">"total"</span><span class="paren">)</span>

<span class="identifier">percent_assigned_80</span> <span class="operator">&lt;-</span> <span class="identifier">counts_table</span><span class="operator">$</span><span class="identifier">species</span> <span class="operator">/</span> <span class="identifier">total_counts</span>

<span class="identifier">print</span> <span class="paren">(</span><span class="string">"Counts assigned to species level, with an id &gt;= .80 filter for Blast and Vsearch"</span><span class="paren">)</span></code></pre>
<pre><code>## [1] "Counts assigned to species level, with an id &gt;= .80 filter for Blast and Vsearch"</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="identifier">counts_table</span><span class="paren">)</span></code></pre>
<pre><code>##    Source species genus family order class phylum kingdom unassigned total
## 1 Vsearch     321     0      0     0     0      0       0          2   323
## 2  Ecotag     136    48     58    74    86    169     187         61   819
## 3   Blast     727     1      0     0     0      0       0          0   728
## 4     SAP      58    35     13     8    13     28       0          0   155</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="string">"Percent assigned to species level, with an id &gt;= .80 filter for Blast and Vsearch"</span><span class="paren">)</span></code></pre>
<pre><code>## [1] "Percent assigned to species level, with an id &gt;= .80 filter for Blast and Vsearch"</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="identifier">percent_assigned_80</span><span class="paren">)</span></code></pre>
<pre><code>## [1] 0.6844350 0.1660562 0.9008674 0.3741935</code></pre>
<pre><code>##      Source    species genus family order class phylum kingdom
## [1,] "Vsearch" "197"   "165" "115"  "65"  "26"  "14"   "3"    
## [2,] "Ecotag"  "103"   "120" "119"  "79"  "38"  "22"   "4"    
## [3,] "Blast"   "510"   "382" "281"  "127" "51"  "26"   "4"    
## [4,] "SAP"     "55"    "79"  "66"   "41"  "19"  "9"    "3"</code></pre>
<pre><code>##         Ecotag, Vsearch Ecotag, Blast Ecotag, SAP Vsearch, Blast
## species              41            49          17            156
## genus                65            78          35            147
## family               65            85          44            102
## order                45            61          32             62
## class                24            31          18             26
## phylum               13            20           9             14
## kingdom               3             4           3              3
##         Vsearch, SAP Blast, SAP Ecotag, Vsearch, Blast
## species           49         52                     36
## genus             76         78                     62
## family            63         66                     63
## order             40         40                     44
## class             18         18                     24
## phylum             9          9                     13
## kingdom            3          3                      3
##         Ecotag, Vsearch, SAP Vsearch, Blast, SAP
## species                   17                  48
## genus                     35                  76
## family                    43                  63
## order                     32                  40
## class                     18                  18
## phylum                     9                   9
## kingdom                    3                   3
##         Ecotag, Vsearch, Blast, SAP
## species                          16
## genus                            35
## family                           43
## order                            32
## class                            18
## phylum                            9
## kingdom                           3</code></pre>
<pre><code>##      Source    species genus family order class phylum kingdom
## [1,] "Vsearch" "197"   "165" "115"  "65"  "26"  "14"   "3"    
## [2,] "Ecotag"  "103"   "120" "119"  "79"  "38"  "22"   "4"    
## [3,] "Blast"   "510"   "382" "281"  "127" "51"  "26"   "4"    
## [4,] "SAP"     "55"    "79"  "66"   "41"  "19"  "9"    "3"</code></pre>
<pre><code>## [1] "Unique class counts (ID &gt;= .80 filter)"</code></pre>
<pre><code>##        Malacostraca     Sordariomycetes  Microbotryomycetes 
##                  37                  12                   2 
##         Actinopteri         Maxillopoda         Cephalopoda 
##                 181                  11                   9 
##            Mammalia     Dothideomycetes       Leotiomycetes 
##                  11                  14                   8 
##      Eurotiomycetes         Sagittoidea          Gastropoda 
##                   4                   2                   5 
##           Oomycetes           Ostracoda      Chondrichthyes 
##                   1                   1                   7 
##        Phaeophyceae             Insecta                     
##                   1                   3                   5 
##         Dinophyceae     Saccharomycetes    Prymnesiophyceae 
##                   1                   1                   1 
##                Aves         Ophiuroidea            Hydrozoa 
##                   1                   1                   2 
## Coscinodiscophyceae            Amphibia 
##                   1                   1</code></pre>
<pre><code>##         Chromadorea                            Malacostraca 
##                   7                 421                  75 
##         Sagittoidea         Conoidasida  Microbotryomycetes 
##                   5                   4                   3 
##         Actinopteri         Maxillopoda          Polychaeta 
##                 149                  16                  13 
##             Cestoda            Mammalia      Agaricomycetes 
##                  15                   8                   3 
##            Bivalvia       Enteropneusta     Saccharomycetes 
##                   3                   1                   3 
##         Cephalopoda            Hydrozoa          Gastropoda 
##                   8                  10                  12 
##      Eurotiomycetes     Sordariomycetes           Oomycetes 
##                   5                  12                   3 
##           Ostracoda             Insecta      Chondrichthyes 
##                   2                   6                   7 
##             Enoplea         Tentaculata   Bacillariophyceae 
##                   3                   2                   3 
##     Dothideomycetes         Dinophyceae    Prymnesiophyceae 
##                   4                   2                   1 
##                Aves Coscinodiscophyceae         Ophiuroidea 
##                   1                   5                   1 
## Chlorodendrophyceae              Enopla              Anopla 
##                   1                   1                   2 
##         Turbellaria       Leotiomycetes 
##                   1                   1</code></pre>
<pre><code>##         Chromadorea         Turbellaria        Malacostraca 
##                   7                   2                 187 
##         Sagittoidea            Coccidia     Sordariomycetes 
##                   4                   4                  19 
##          Gastropoda         Actinopteri             Insecta 
##                  16                 230                  59 
##      Palaeonemertea         Maxillopoda           Arachnida 
##                   4                  18                  13 
##            Hydrozoa             Cestoda              Anopla 
##                  11                   8                   3 
##          Polychaeta            Mammalia         Cephalopoda 
##                  25                  12                  15 
##      Prasinophyceae      Agaricomycetes       Onychophorida 
##                   1                   3                   1 
##       Leotiomycetes                          Eurotiomycetes 
##                  10                  14                  10 
##          Clitellata     Saccharomycetes           Oomycetes 
##                   3                   3                   2 
##          Collembola            Reptilia      Raphidophyceae 
##                   1                   1                   1 
##           Ostracoda      Chondrichthyes                Nuda 
##                   1                   7                   1 
##   Bacillariophyceae        Phaeophyceae     Dothideomycetes 
##                   4                   3                   5 
##           Scyphozoa             Protura         Dinophyceae 
##                   1                   1                   1 
##     Lecanoromycetes    Prymnesiophyceae                Aves 
##                   1                   1                   1 
##    Trebouxiophyceae Coscinodiscophyceae            Amphibia 
##                   1                   5                   1 
##         Ophiuroidea          Bdelloidea           Trematoda 
##                   1                   1                   2 
##         Zygomycetes  Microbotryomycetes        Gymnolaemata 
##                   1                   1                   1</code></pre>
<pre><code>##      Actinopteri   Chondrichthyes                      Malacostraca 
##               64                3               28               18 
##  Sordariomycetes       Gastropoda   Eurotiomycetes         Mammalia 
##                4                4                2                5 
##      Sagittoidea      Cephalopoda      Ophiuroidea  Dothideomycetes 
##                2                6                1                1 
##      Maxillopoda          Insecta             Aves         Oomycota 
##                9                3                1                1 
##        Ostracoda Prymnesiophyceae         Hydrozoa 
##                1                1                1</code></pre>
<pre><code>## [1] "Unique phylum counts (ID &gt;= .80 filter)"</code></pre>
<pre><code>##       Arthropoda       Ascomycota    Basidiomycota         Chordata 
##               52               39                2              202 
##         Mollusca     Chaetognatha Heterokontophyta     Phaeophyceae 
##               14                2                1                1 
##  Pyrrophycophyta                        Haptophyta    Echinodermata 
##                1                4                1                1 
##         Cnidaria  Bacillariophyta 
##                2                1</code></pre>
<pre><code>##         Nematoda  Platyhelminthes       Arthropoda     Chaetognatha 
##               10               19              190                5 
##      Apicomplexa       Ascomycota                     Basidiomycota 
##                4               35              251                6 
##         Chordata         Annelida         Mollusca     Hemichordata 
##              221               24               23                1 
##         Cnidaria Heterokontophyta       Ctenophora  Bacillariophyta 
##               10                1                2                8 
##  Pyrrophycophyta       Haptophyta         Nemertea    Echinodermata 
##                1                1                4                1 
##      Chlorophyta     Mucoromycota 
##                1                1</code></pre>
<pre><code>##         Nematoda  Platyhelminthes       Arthropoda     Chaetognatha 
##                7               12              283                4 
##      Apicomplexa       Ascomycota         Mollusca         Chordata 
##                4               48               31              257 
##         Nemertea         Cnidaria         Annelida      Chlorophyta 
##                8               12               28                2 
##    Basidiomycota      Onychophora                        Ochrophyta 
##                4                1                5                1 
## Heterokontophyta       Ctenophora  Bacillariophyta     Phaeophyceae 
##                1                2                9                3 
##  Pyrrophycophyta       Haptophyta    Echinodermata         Rotifera 
##                1                1                1                1 
##       Zygomycota          Bryozoa 
##                1                1</code></pre>
<pre><code>##         Chordata         Mollusca       Arthropoda       Ascomycota 
##               96               11               33                9 
##     Chaetognatha    Echinodermata Heterokontophyta       Haptophyta 
##                2                1                1                1 
##         Cnidaria 
##                1</code></pre>
<pre><code>## [1] "Unique kingdom counts (ID &gt;= .80 filter)"</code></pre>
<pre><code>## Metazoa   Fungi         
##     273      41       9</code></pre>
<pre><code>##       Metazoa                       Fungi Viridiplantae 
##           697            79            42             1</code></pre>
<pre><code>##       Metazoa                       Fungi Viridiplantae 
##           650            23            53             2</code></pre>
<pre><code>## Metazoa   Fungi         
##     144       9       2</code></pre>
</div>
<div id="section-venn-diagrams-of-unique-phylum-intersection-after-the-id-.80-filter" class="section level3">
<h3>Venn diagrams of unique phylum intersection after the id &gt;= .80 filter</h3>
<pre class="r"><code class="r"><span class="comment"># SAP complete</span>

<span class="identifier">vn_phylum</span> <span class="operator">&lt;-</span> <span class="identifier">list</span> <span class="paren">(</span><span class="number">0</span><span class="paren">)</span>
<span class="identifier">vn_phylum</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">vsearch_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">phylum</span>
<span class="identifier">vn_phylum</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">ecotag_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">phylum</span>
<span class="identifier">vn_phylum</span><span class="paren">[</span><span class="paren">[</span><span class="number">3</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">blast_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">phylum</span>
<span class="identifier">vn_phylum</span><span class="paren">[</span><span class="paren">[</span><span class="number">4</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">sap_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">phylum</span>
<span class="identifier">names</span> <span class="paren">(</span><span class="identifier">vn_phylum</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"Vsearch"</span>, <span class="string">"Ecotag"</span>, <span class="string">"Blast"</span>, <span class="string">"SAP"</span><span class="paren">)</span>
<span class="identifier">plot</span> <span class="paren">(</span><span class="identifier">Venn</span> <span class="paren">(</span><span class="identifier">vn_phylum</span><span class="paren">)</span>, <span class="identifier">doWeights</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></code></pre>
<p><img src="report_files/taxon_80_venn-1.png" width="672"></p>
<pre class="r"><code class="r"><span class="identifier">plot</span> <span class="paren">(</span><span class="identifier">Venn</span> <span class="paren">(</span><span class="identifier">vn_phylum</span><span class="paren">)</span>, <span class="identifier">doWeights</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">show</span> <span class="operator">=</span> <span class="identifier">list</span> <span class="paren">(</span><span class="identifier">SetLabels</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">FaceText</span> <span class="operator">=</span> <span class="string">""</span><span class="paren">)</span><span class="paren">)</span></code></pre>
<p><img src="report_files/taxon_80_venn-2.png" width="672"></p>
</div>
<div id="section-part-3-97-identity-filter" class="section level3">
<h3>Part 3: 97% identity filter</h3>
<pre class="r"><code class="r"><span class="comment"># SAP complete</span>

<span class="identifier">taxonomicRanksOfInterest</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"species"</span>, <span class="string">"genus"</span>, <span class="string">"family"</span>, <span class="string">"order"</span>, <span class="string">"class"</span>, <span class="string">"phylum"</span>, <span class="string">"kingdom"</span><span class="paren">)</span>

<span class="comment"># Vsearch</span>
<span class="identifier">ovt_vsearch_97</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_vsearch</span><span class="paren">[</span><span class="identifier">ovt_vsearch</span><span class="operator">$</span><span class="identifier">VSEARCH_IDENTITY_NT</span> <span class="operator">&gt;=</span> <span class="number">97</span>,<span class="paren">]</span>

<span class="identifier">vsearch_taxonomy</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_vsearch_97</span><span class="paren">[</span>,<span class="identifier">taxonomicRanksOfInterest</span><span class="paren">]</span>
<span class="identifier">vsearch_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">vsearch_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">vsearch_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">vsearch_best_match_scinames</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">vsearch_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">vsearch_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">vsearch_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">vsearch_best_match_levels</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">vsearch_best_match</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">ovt_vsearch_97</span><span class="operator">$</span><span class="identifier">OTU_SEQID</span>, 
                                        <span class="identifier">vsearch_best_match_scinames</span>, <span class="identifier">vsearch_best_match_levels</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">vsearch_best_match</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"OTU_SEQID"</span>, <span class="string">"SCINAME"</span>, <span class="string">"LEVEL"</span><span class="paren">)</span>

  
<span class="comment"># Ecotag (Ignore filter since "smart")</span>
<span class="identifier">ovt_ecotag_97</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_ecotag</span> 

<span class="identifier">ecotag_taxonomy</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_ecotag_97</span><span class="paren">[</span>,<span class="identifier">taxonomicRanksOfInterest</span><span class="paren">]</span>
<span class="identifier">ecotag_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">ecotag_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">ecotag_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">ecotag_best_match_scinames</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">ecotag_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">ecotag_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">ecotag_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">ecotag_best_match_levels</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">ecotag_best_match</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">ovt_ecotag_97</span><span class="operator">$</span><span class="identifier">OTU_SEQID</span>, 
                                        <span class="identifier">ecotag_best_match_scinames</span>, <span class="identifier">ecotag_best_match_levels</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ecotag_best_match</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"OTU_SEQID"</span>, <span class="string">"SCINAME"</span>, <span class="string">"LEVEL"</span><span class="paren">)</span>


<span class="comment"># Blast</span>
<span class="identifier">ovt_blast_97</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_blast</span><span class="paren">[</span><span class="identifier">ovt_blast</span><span class="operator">$</span><span class="identifier">BLAST_IDENTITY_NT</span> <span class="operator">&gt;=</span> <span class="number">97</span>,<span class="paren">]</span>

<span class="identifier">blast_taxonomy</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_blast_97</span><span class="paren">[</span>,<span class="identifier">taxonomicRanksOfInterest</span><span class="paren">]</span>
<span class="identifier">blast_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">blast_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">blast_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">blast_best_match_scinames</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">blast_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">blast_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">blast_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">blast_best_match_levels</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">blast_best_match</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">ovt_blast_97</span><span class="operator">$</span><span class="identifier">OTU_SEQID</span>, 
                                        <span class="identifier">blast_best_match_scinames</span>, <span class="identifier">blast_best_match_levels</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">blast_best_match</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"OTU_SEQID"</span>, <span class="string">"SCINAME"</span>, <span class="string">"LEVEL"</span><span class="paren">)</span>


<span class="comment"># SAP (Ignore filter since "smart")</span>
<span class="identifier">ovt_sap_97</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_sap</span>

<span class="identifier">sap_taxonomy</span> <span class="operator">&lt;-</span> <span class="identifier">ovt_sap_97</span><span class="paren">[</span>,<span class="identifier">taxonomicRanksOfInterest</span><span class="paren">]</span>
<span class="identifier">sap_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">sap_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">sap_best_match_scinames</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">sap_best_match_scinames</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">sap_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">sap_taxonomy</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">head</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">[</span><span class="identifier">x</span> <span class="operator">!=</span> <span class="string">""</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">sap_best_match_levels</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">sap_best_match_levels</span>, 
                                      <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span>, <span class="string">""</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">sap_best_match</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">ovt_sap_97</span><span class="operator">$</span><span class="identifier">OTU_SEQID</span>, 
                                        <span class="identifier">sap_best_match_scinames</span>, <span class="identifier">sap_best_match_levels</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">sap_best_match</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"OTU_SEQID"</span>, <span class="string">"SCINAME"</span>, <span class="string">"LEVEL"</span><span class="paren">)</span>


<span class="identifier">taxon_level_counts_vsearch</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">taxonomicRanksOfInterest</span>, 
                                      <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">vsearch_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">taxon_level_counts_ecotag</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">taxonomicRanksOfInterest</span>, 
                                     <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">ecotag_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">taxon_level_counts_blast</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">taxonomicRanksOfInterest</span>, 
                                     <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">blast_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">taxon_level_counts_sap</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">taxonomicRanksOfInterest</span>, 
                                     <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">sap_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">empty_taxon_count_vsearch</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">vsearch_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="string">""</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">empty_taxon_count_ecotag</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">ecotag_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="string">""</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">empty_taxon_count_blast</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">blast_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="string">""</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">empty_taxon_count_sap</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">sap_best_match</span><span class="operator">$</span><span class="identifier">LEVEL</span> <span class="operator">==</span> <span class="string">""</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">empty_counts</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="identifier">empty_taxon_count_vsearch</span>, <span class="identifier">empty_taxon_count_ecotag</span>, <span class="identifier">empty_taxon_count_blast</span>, <span class="identifier">empty_taxon_count_sap</span><span class="paren">)</span>


<span class="identifier">total_count_vsearch</span> <span class="operator">&lt;-</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">taxon_level_counts_vsearch</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">empty_taxon_count_vsearch</span>
<span class="identifier">total_count_ecotag</span> <span class="operator">&lt;-</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">taxon_level_counts_ecotag</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">empty_taxon_count_ecotag</span>
<span class="identifier">total_count_blast</span> <span class="operator">&lt;-</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">taxon_level_counts_blast</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">empty_taxon_count_blast</span>
<span class="identifier">total_count_sap</span> <span class="operator">&lt;-</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">taxon_level_counts_sap</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">empty_taxon_count_sap</span>
<span class="identifier">total_counts_97</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="identifier">total_count_vsearch</span>, <span class="identifier">total_count_ecotag</span>, <span class="identifier">total_count_blast</span>, <span class="identifier">total_count_sap</span><span class="paren">)</span>
   

<span class="comment"># ASSERTION: total_counts should equal the nrow (ovt_XXX_97)</span>
    
<span class="identifier">titles_col</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"Vsearch"</span>, <span class="string">"Ecotag"</span>, <span class="string">"Blast"</span>, <span class="string">"SAP"</span><span class="paren">)</span>
<span class="identifier">counts_table</span> <span class="operator">&lt;-</span> <span class="identifier">rbind.data.frame</span> <span class="paren">(</span><span class="identifier">taxon_level_counts_vsearch</span>, <span class="identifier">taxon_level_counts_ecotag</span>, <span class="identifier">taxon_level_counts_blast</span>, <span class="identifier">taxon_level_counts_sap</span><span class="paren">)</span>
<span class="identifier">counts_table</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span><span class="paren">(</span><span class="identifier">titles_col</span>, <span class="identifier">counts_table</span>, <span class="identifier">empty_counts</span>, <span class="identifier">total_counts_97</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">counts_table</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"Source"</span>, <span class="identifier">taxonomicRanksOfInterest</span>, <span class="string">"unassigned"</span>, <span class="string">"total"</span><span class="paren">)</span>

<span class="identifier">percent_assigned_97</span> <span class="operator">&lt;-</span> <span class="identifier">counts_table</span><span class="operator">$</span><span class="identifier">species</span> <span class="operator">/</span> <span class="identifier">total_counts</span>

<span class="identifier">print</span> <span class="paren">(</span><span class="string">"Counts assigned to species level, with an id &gt;= .97 filter for Blast and Vsearch"</span><span class="paren">)</span></code></pre>
<pre><code>## [1] "Counts assigned to species level, with an id &gt;= .97 filter for Blast and Vsearch"</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="identifier">counts_table</span><span class="paren">)</span></code></pre>
<pre><code>##    Source species genus family order class phylum kingdom unassigned total
## 1 Vsearch     157     0      0     0     0      0       0          2   159
## 2  Ecotag     136    48     58    74    86    169     187         61   819
## 3   Blast     174     0      0     0     0      0       0          0   174
## 4     SAP      58    35     13     8    13     28       0          0   155</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="string">"Percent assigned to species level, with an id &gt;= .97 filter for Blast and Vsearch"</span><span class="paren">)</span></code></pre>
<pre><code>## [1] "Percent assigned to species level, with an id &gt;= .97 filter for Blast and Vsearch"</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="identifier">percent_assigned_97</span><span class="paren">)</span></code></pre>
<pre><code>## [1] 0.3347548 0.1660562 0.2156134 0.3741935</code></pre>
<pre class="r"><code class="r"><span class="comment"># bar plot of proportion assigned at species level</span>
<span class="comment">#df &lt;- cbind.data.frame (counts_table$Source, percent_assigned)</span>
<span class="comment">#colnames (df) &lt;- c ("source", "proportions")</span>
<span class="comment">#ggplot (data=df, aes(y=proportions, x=source, fill=source)) + geom_bar(stat="identity", color = "black" ) + scale_fill_manual(values=c("#bebada", "#8dd3c7", "#ffffb3")) + ylim(0,1)</span>

<span class="identifier">dat2</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span>
    <span class="keyword">source</span> <span class="operator">=</span> <span class="identifier">factor</span><span class="paren">(</span><span class="identifier">c</span><span class="paren">(</span><span class="string">"Vsearch"</span>,<span class="string">"Vsearch"</span>,<span class="string">"Ecotag"</span>,<span class="string">"Ecotag"</span>, <span class="string">"Blast"</span>, <span class="string">"Blast"</span>, <span class="string">"SAP"</span>, <span class="string">"SAP"</span><span class="paren">)</span><span class="paren">)</span>,
    <span class="identifier">filter</span> <span class="operator">=</span> <span class="identifier">factor</span><span class="paren">(</span><span class="identifier">c</span><span class="paren">(</span><span class="string">"Before Filter"</span>,<span class="string">"97% Filter"</span>,<span class="string">"Before Filter"</span>,<span class="string">"97% Filter"</span>,
                      <span class="string">"Before Filter"</span>,<span class="string">"97% Filter"</span>, <span class="string">"Before Filter"</span>, <span class="string">"97% Filter"</span><span class="paren">)</span>, <span class="identifier">levels</span><span class="operator">=</span><span class="identifier">c</span><span class="paren">(</span><span class="string">"Before Filter"</span>,<span class="string">"97% Filter"</span><span class="paren">)</span><span class="paren">)</span>,
    <span class="identifier">assigned</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">percent_assigned</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">percent_assigned_97</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span>, 
                   <span class="identifier">percent_assigned</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">percent_assigned_97</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span>,
                   <span class="identifier">percent_assigned</span><span class="paren">[</span><span class="paren">[</span><span class="number">3</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">percent_assigned_97</span><span class="paren">[</span><span class="paren">[</span><span class="number">3</span><span class="paren">]</span><span class="paren">]</span>,
                   <span class="identifier">percent_assigned</span><span class="paren">[</span><span class="paren">[</span><span class="number">4</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">percent_assigned_97</span><span class="paren">[</span><span class="paren">[</span><span class="number">4</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>
<span class="paren">)</span></code></pre>
</div>
</div>
<div id="section-proportion-of-otus-assigned-to-species" class="section level2">
<h2>Proportion of OTUs assigned to species</h2>
<p><strong>Is this not problematic because many OTUs are not even returned for SAP? Vsearch?</strong></p>
<pre class="r"><code class="r"><span class="comment"># SAP complete</span>

<span class="comment"># bar plot of proportion assigned at species level</span>
<span class="identifier">df</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">counts_table</span><span class="operator">$</span><span class="identifier">Source</span>, <span class="identifier">percent_assigned_97</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"source"</span>, <span class="string">"proportions"</span><span class="paren">)</span>
<span class="identifier">ggplot</span> <span class="paren">(</span><span class="identifier">data</span><span class="operator">=</span><span class="identifier">df</span>, <span class="identifier">aes</span><span class="paren">(</span><span class="identifier">y</span><span class="operator">=</span><span class="identifier">proportions</span>, <span class="identifier">x</span><span class="operator">=</span><span class="keyword">source</span>, <span class="identifier">fill</span><span class="operator">=</span><span class="keyword">source</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">geom_bar</span><span class="paren">(</span><span class="identifier">stat</span><span class="operator">=</span><span class="string">"identity"</span>, <span class="identifier">color</span> <span class="operator">=</span> <span class="string">"black"</span> <span class="paren">)</span> <span class="operator">+</span> <span class="identifier">scale_fill_manual</span><span class="paren">(</span><span class="identifier">values</span><span class="operator">=</span><span class="identifier">c</span><span class="paren">(</span><span class="string">"#bebada"</span>, <span class="string">"#8dd3c7"</span>, <span class="string">"#ffaabc"</span>, <span class="string">"#ffffb3"</span> <span class="paren">)</span><span class="paren">)</span></code></pre>
<p><img src="report_files/unnamed-chunk-9-1.png" width="672"></p>
<pre class="r"><code class="r"><span class="comment"># bar plot rank assignments for Ecotag  </span>
<span class="identifier">proportions</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">counts_table</span><span class="paren">[</span><span class="number">2</span>,<span class="paren">]</span><span class="paren">[</span><span class="number">2</span><span class="operator">:</span><span class="number">8</span><span class="paren">]</span><span class="paren">[</span><span class="number">1</span>,<span class="paren">]</span> <span class="operator">/</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">counts_table</span><span class="paren">[</span><span class="number">2</span>,<span class="paren">]</span><span class="paren">[</span><span class="number">2</span><span class="operator">:</span><span class="number">8</span><span class="paren">]</span><span class="paren">[</span><span class="number">1</span>,<span class="paren">]</span> <span class="paren">)</span><span class="paren">)</span>
<span class="identifier">df_97</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">proportions</span>, <span class="identifier">taxonomicRanksOfInterest</span><span class="paren">)</span>
<span class="identifier">df_97</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">taxon_rank</span> <span class="operator">=</span> <span class="identifier">taxonomicRanksOfInterest</span>, <span class="identifier">proportions</span><span class="paren">)</span>
<span class="identifier">ggplot</span> <span class="paren">(</span><span class="identifier">data</span><span class="operator">=</span><span class="identifier">df_97</span>, <span class="identifier">aes</span><span class="paren">(</span><span class="identifier">y</span><span class="operator">=</span><span class="identifier">proportions</span>, <span class="identifier">x</span><span class="operator">=</span><span class="identifier">taxon_rank</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">geom_bar</span><span class="paren">(</span><span class="identifier">stat</span><span class="operator">=</span><span class="string">"identity"</span>, <span class="identifier">fill</span> <span class="operator">=</span> <span class="string">"#8dd3c7"</span>, <span class="identifier">color</span> <span class="operator">=</span> <span class="string">"black"</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">scale_x_discrete</span> <span class="paren">(</span><span class="identifier">limits</span> <span class="operator">=</span> <span class="identifier">taxonomicRanksOfInterest</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">scale_y_continuous</span><span class="paren">(</span><span class="identifier">labels</span> <span class="operator">=</span> <span class="identifier">scales</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">percent</span><span class="paren">)</span></code></pre>
<p><img src="report_files/unnamed-chunk-9-2.png" width="672"></p>
<pre class="r"><code class="r"><span class="comment"># bar plot rank assignments for SAP</span>
<span class="identifier">query</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">c</span> <span class="paren">(</span><span class="identifier">taxonomicRanksOfInterest</span> <span class="paren">)</span><span class="paren">)</span> <span class="comment">#, "unranked"))</span>
<span class="identifier">proportions</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span> <span class="paren">(</span><span class="identifier">counts_table</span><span class="paren">[</span><span class="number">4</span>,<span class="paren">]</span><span class="paren">[</span><span class="number">2</span><span class="operator">:</span><span class="number">8</span><span class="paren">]</span><span class="paren">[</span><span class="number">1</span>,<span class="paren">]</span> <span class="operator">/</span> <span class="identifier">total_counts</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>
<span class="identifier">df</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">taxon_rank</span> <span class="operator">=</span> <span class="identifier">query</span>, <span class="identifier">proportions</span><span class="paren">)</span>
<span class="identifier">ggplot</span> <span class="paren">(</span><span class="identifier">data</span><span class="operator">=</span><span class="identifier">df</span>, <span class="identifier">aes</span><span class="paren">(</span><span class="identifier">y</span><span class="operator">=</span><span class="identifier">proportions</span>, <span class="identifier">x</span><span class="operator">=</span><span class="identifier">taxon_rank</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">geom_bar</span><span class="paren">(</span><span class="identifier">stat</span><span class="operator">=</span><span class="string">"identity"</span>, <span class="identifier">fill</span> <span class="operator">=</span> <span class="string">"#8dd3c7"</span>, <span class="identifier">color</span> <span class="operator">=</span> <span class="string">"black"</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">scale_x_discrete</span> <span class="paren">(</span><span class="identifier">limits</span> <span class="operator">=</span> <span class="identifier">query</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">scale_y_continuous</span><span class="paren">(</span><span class="identifier">labels</span> <span class="operator">=</span> <span class="identifier">scales</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">percent</span><span class="paren">)</span></code></pre>
<p><img src="report_files/unnamed-chunk-9-3.png" width="672"></p>
<pre class="r"><code class="r"><span class="comment"># SAP complete</span>

<span class="identifier">uniqRanks</span> <span class="operator">&lt;-</span> <span class="identifier">cbind</span> <span class="paren">(</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"Vsearch"</span>, <span class="string">"Ecotag"</span>, <span class="string">"Blast"</span>, <span class="string">"SAP"</span><span class="paren">)</span>, <span class="identifier">rbind</span> <span class="paren">(</span>
<span class="identifier">apply</span><span class="paren">(</span><span class="identifier">vsearch_taxonomy</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">2</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">unique</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>,
<span class="identifier">apply</span><span class="paren">(</span><span class="identifier">ecotag_taxonomy</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">2</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">unique</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>,
<span class="identifier">apply</span><span class="paren">(</span><span class="identifier">blast_taxonomy</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">2</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">unique</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>,
<span class="identifier">apply</span><span class="paren">(</span><span class="identifier">sap_taxonomy</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">2</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">unique</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">uniqRanks</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="string">"Source"</span>
<span class="identifier">print</span> <span class="paren">(</span><span class="identifier">uniqRanks</span><span class="paren">)</span></code></pre>
<pre><code>##      Source    species genus family order class phylum kingdom
## [1,] "Vsearch" "153"   "135" "93"   "53"  "21"  "13"   "3"    
## [2,] "Ecotag"  "103"   "120" "119"  "79"  "38"  "22"   "4"    
## [3,] "Blast"   "157"   "138" "96"   "54"  "22"  "13"   "3"    
## [4,] "SAP"     "55"    "79"  "66"   "41"  "19"  "9"    "3"</code></pre>
<pre class="r"><code class="r"><span class="identifier">intersect_counts_EV</span> <span class="operator">&lt;-</span> <span class="identifier">intersect_taxonomy</span><span class="paren">(</span><span class="identifier">A</span> <span class="operator">=</span> <span class="identifier">vsearch_taxonomy</span>, <span class="identifier">B</span> <span class="operator">=</span> <span class="identifier">ecotag_taxonomy</span><span class="paren">)</span>
<span class="identifier">intersect_counts_EB</span> <span class="operator">&lt;-</span> <span class="identifier">intersect_taxonomy</span><span class="paren">(</span><span class="identifier">A</span> <span class="operator">=</span> <span class="identifier">ecotag_taxonomy</span>, <span class="identifier">B</span> <span class="operator">=</span> <span class="identifier">blast_taxonomy</span><span class="paren">)</span>
<span class="identifier">intersect_counts_BV</span> <span class="operator">&lt;-</span> <span class="identifier">intersect_taxonomy</span><span class="paren">(</span><span class="identifier">A</span> <span class="operator">=</span> <span class="identifier">vsearch_taxonomy</span>, <span class="identifier">B</span> <span class="operator">=</span> <span class="identifier">blast_taxonomy</span><span class="paren">)</span>

<span class="identifier">intersect_counts_ES</span> <span class="operator">&lt;-</span> <span class="identifier">intersect_taxonomy</span><span class="paren">(</span><span class="identifier">A</span> <span class="operator">=</span> <span class="identifier">ecotag_taxonomy</span>, <span class="identifier">B</span> <span class="operator">=</span> <span class="identifier">sap_taxonomy</span><span class="paren">)</span>
<span class="identifier">intersect_counts_VS</span> <span class="operator">&lt;-</span> <span class="identifier">intersect_taxonomy</span><span class="paren">(</span><span class="identifier">A</span> <span class="operator">=</span> <span class="identifier">vsearch_taxonomy</span>, <span class="identifier">B</span> <span class="operator">=</span> <span class="identifier">sap_taxonomy</span><span class="paren">)</span>
<span class="identifier">intersect_counts_BS</span> <span class="operator">&lt;-</span> <span class="identifier">intersect_taxonomy</span><span class="paren">(</span><span class="identifier">A</span> <span class="operator">=</span> <span class="identifier">blast_taxonomy</span>, <span class="identifier">B</span> <span class="operator">=</span> <span class="identifier">sap_taxonomy</span><span class="paren">)</span>

<span class="identifier">intersect_counts_EBV</span> <span class="operator">&lt;-</span> <span class="identifier">intersect_taxonomy_three</span><span class="paren">(</span><span class="identifier">A</span> <span class="operator">=</span> <span class="identifier">vsearch_taxonomy</span>, <span class="identifier">B</span> <span class="operator">=</span> <span class="identifier">ecotag_taxonomy</span>, <span class="identifier">C</span> <span class="operator">=</span> <span class="identifier">blast_taxonomy</span><span class="paren">)</span>
<span class="identifier">intersect_counts_EVS</span> <span class="operator">&lt;-</span> <span class="identifier">intersect_taxonomy_three</span><span class="paren">(</span><span class="identifier">A</span> <span class="operator">=</span> <span class="identifier">vsearch_taxonomy</span>, <span class="identifier">B</span> <span class="operator">=</span> <span class="identifier">ecotag_taxonomy</span>, <span class="identifier">C</span> <span class="operator">=</span> <span class="identifier">sap_taxonomy</span><span class="paren">)</span>
<span class="identifier">intersect_counts_BVS</span> <span class="operator">&lt;-</span> <span class="identifier">intersect_taxonomy_three</span><span class="paren">(</span><span class="identifier">A</span> <span class="operator">=</span> <span class="identifier">vsearch_taxonomy</span>, <span class="identifier">B</span> <span class="operator">=</span> <span class="identifier">sap_taxonomy</span>, <span class="identifier">C</span> <span class="operator">=</span> <span class="identifier">blast_taxonomy</span><span class="paren">)</span>

<span class="identifier">intersect_counts_EBVS</span> <span class="operator">&lt;-</span> <span class="identifier">intersect_taxonomy_four</span><span class="paren">(</span><span class="identifier">A</span> <span class="operator">=</span> <span class="identifier">vsearch_taxonomy</span>, <span class="identifier">B</span> <span class="operator">=</span> <span class="identifier">ecotag_taxonomy</span>, <span class="identifier">C</span> <span class="operator">=</span> <span class="identifier">blast_taxonomy</span>, <span class="identifier">D</span> <span class="operator">=</span> <span class="identifier">sap_taxonomy</span><span class="paren">)</span>


<span class="identifier">intersect_counts_table</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span><span class="identifier">intersect_counts_EV</span>, <span class="identifier">intersect_counts_EB</span>, <span class="identifier">intersect_counts_ES</span>, 
                                            <span class="identifier">intersect_counts_BV</span>, <span class="identifier">intersect_counts_VS</span>, <span class="identifier">intersect_counts_BS</span>,
                                            <span class="identifier">intersect_counts_EBV</span>, <span class="identifier">intersect_counts_EVS</span>, <span class="identifier">intersect_counts_BVS</span>,
                                            <span class="identifier">intersect_counts_EBVS</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">intersect_counts_table</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"Ecotag, Vsearch"</span>, <span class="string">"Ecotag, Blast"</span>, <span class="string">"Ecotag, SAP"</span>,
                                        <span class="string">"Vsearch, Blast"</span>, <span class="string">"Vsearch, SAP"</span>, <span class="string">"Blast, SAP"</span>,
                                        <span class="string">"Ecotag, Vsearch, Blast"</span>, <span class="string">"Ecotag, Vsearch, SAP"</span>, <span class="string">"Vsearch, Blast, SAP"</span>,
                                        <span class="string">"Ecotag, Vsearch, Blast, SAP"</span><span class="paren">)</span>
<span class="identifier">rownames</span> <span class="paren">(</span><span class="identifier">intersect_counts_table</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">taxonomicRanksOfInterest</span>
<span class="identifier">print</span> <span class="paren">(</span><span class="identifier">intersect_counts_table</span><span class="paren">)</span></code></pre>
<pre><code>##         Ecotag, Vsearch Ecotag, Blast Ecotag, SAP Vsearch, Blast
## species              33            32          17            139
## genus                57            55          35            131
## family               58            57          44             91
## order                41            40          32             51
## class                21            22          18             21
## phylum               13            13           9             13
## kingdom               3             3           3              3
##         Vsearch, SAP Blast, SAP Ecotag, Vsearch, Blast
## species           47         46                     31
## genus             70         71                     55
## family            60         61                     57
## order             39         40                     39
## class             17         18                     21
## phylum             9          9                     13
## kingdom            3          3                      3
##         Ecotag, Vsearch, SAP Vsearch, Blast, SAP
## species                   15                  45
## genus                     31                  70
## family                    40                  60
## order                     31                  39
## class                     17                  17
## phylum                     9                   9
## kingdom                    3                   3
##         Ecotag, Vsearch, Blast, SAP
## species                          13
## genus                            31
## family                           40
## order                            31
## class                            17
## phylum                            9
## kingdom                           3</code></pre>
<pre class="r"><code class="r"><span class="identifier">uniqRanks</span> <span class="operator">&lt;-</span> <span class="identifier">cbind</span> <span class="paren">(</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"Vsearch"</span>, <span class="string">"Ecotag"</span>, <span class="string">"Blast"</span>, <span class="string">"SAP"</span><span class="paren">)</span>, <span class="identifier">rbind</span> <span class="paren">(</span>
<span class="identifier">apply</span><span class="paren">(</span><span class="identifier">vsearch_taxonomy</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">2</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">unique</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>,
<span class="identifier">apply</span><span class="paren">(</span><span class="identifier">ecotag_taxonomy</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">2</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">unique</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>,
<span class="identifier">apply</span><span class="paren">(</span><span class="identifier">blast_taxonomy</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">2</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">unique</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>,
<span class="identifier">apply</span><span class="paren">(</span><span class="identifier">sap_taxonomy</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">2</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">unique</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">)</span> <span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">uniqRanks</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="string">"Source"</span>

<span class="identifier">print</span> <span class="paren">(</span><span class="identifier">uniqRanks</span><span class="paren">)</span></code></pre>
<pre><code>##      Source    species genus family order class phylum kingdom
## [1,] "Vsearch" "153"   "135" "93"   "53"  "21"  "13"   "3"    
## [2,] "Ecotag"  "103"   "120" "119"  "79"  "38"  "22"   "4"    
## [3,] "Blast"   "157"   "138" "96"   "54"  "22"  "13"   "3"    
## [4,] "SAP"     "55"    "79"  "66"   "41"  "19"  "9"    "3"</code></pre>
<pre class="r"><code class="r"><span class="comment"># Get counts of specific unique ranks within a level</span>
<span class="identifier">vsearch_taxonomy_uniq</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">vsearch_taxonomy</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">2</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">unique</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">ecotag_taxonomy_uniq</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">ecotag_taxonomy</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">2</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">unique</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">blast_taxonomy_uniq</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">blast_taxonomy</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">2</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">unique</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">sap_taxonomy_uniq</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">sap_taxonomy</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">2</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">unique</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span>

<span class="comment"># Vsearch class counts</span>
<span class="identifier">vsearch_class_counts</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">vsearch_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">class</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">vsearch_taxonomy</span><span class="operator">$</span><span class="identifier">class</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">vsearch_phylum_counts</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">vsearch_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">phylum</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">vsearch_taxonomy</span><span class="operator">$</span><span class="identifier">phylum</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">vsearch_kingdom_counts</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">vsearch_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">kingdom</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">vsearch_taxonomy</span><span class="operator">$</span><span class="identifier">kingdom</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>

<span class="comment"># Ecotag class counts</span>
<span class="identifier">ecotag_class_counts</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">ecotag_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">class</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">ecotag_taxonomy</span><span class="operator">$</span><span class="identifier">class</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">ecotag_phylum_counts</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">ecotag_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">phylum</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">ecotag_taxonomy</span><span class="operator">$</span><span class="identifier">phylum</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">ecotag_kingdom_counts</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">ecotag_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">kingdom</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">ecotag_taxonomy</span><span class="operator">$</span><span class="identifier">kingdom</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>

<span class="comment"># Blast class counts</span>
<span class="identifier">blast_class_counts</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">blast_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">class</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">blast_taxonomy</span><span class="operator">$</span><span class="identifier">class</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">blast_phylum_counts</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">blast_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">phylum</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">blast_taxonomy</span><span class="operator">$</span><span class="identifier">phylum</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">blast_kingdom_counts</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">blast_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">kingdom</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">blast_taxonomy</span><span class="operator">$</span><span class="identifier">kingdom</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>

<span class="comment"># SAP class counts</span>
<span class="identifier">sap_class_counts</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">sap_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">class</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">sap_taxonomy</span><span class="operator">$</span><span class="identifier">class</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">sap_phylum_counts</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">sap_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">phylum</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">sap_taxonomy</span><span class="operator">$</span><span class="identifier">phylum</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">sap_kingdom_counts</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">sap_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">kingdom</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">sap_taxonomy</span><span class="operator">$</span><span class="identifier">kingdom</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>

<span class="identifier">print</span> <span class="paren">(</span><span class="string">"Unique class counts (ID &gt;= .97 filter)"</span><span class="paren">)</span></code></pre>
<pre><code>## [1] "Unique class counts (ID &gt;= .97 filter)"</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="identifier">vsearch_class_counts</span><span class="paren">)</span></code></pre>
<pre><code>##        Malacostraca         Maxillopoda         Actinopteri 
##                  23                  10                  88 
##         Cephalopoda         Sagittoidea            Mammalia 
##                   5                   1                   6 
##          Gastropoda           Oomycetes           Ostracoda 
##                   4                   1                   1 
##             Insecta      Eurotiomycetes                     
##                   3                   1                   4 
##         Dinophyceae    Prymnesiophyceae                Aves 
##                   1                   1                   1 
##      Chondrichthyes         Ophiuroidea            Hydrozoa 
##                   2                   1                   2 
## Coscinodiscophyceae     Sordariomycetes  Microbotryomycetes 
##                   1                   2                   1</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="identifier">ecotag_class_counts</span><span class="paren">)</span></code></pre>
<pre><code>##         Chromadorea                            Malacostraca 
##                   7                 421                  75 
##         Sagittoidea         Conoidasida  Microbotryomycetes 
##                   5                   4                   3 
##         Actinopteri         Maxillopoda          Polychaeta 
##                 149                  16                  13 
##             Cestoda            Mammalia      Agaricomycetes 
##                  15                   8                   3 
##            Bivalvia       Enteropneusta     Saccharomycetes 
##                   3                   1                   3 
##         Cephalopoda            Hydrozoa          Gastropoda 
##                   8                  10                  12 
##      Eurotiomycetes     Sordariomycetes           Oomycetes 
##                   5                  12                   3 
##           Ostracoda             Insecta      Chondrichthyes 
##                   2                   6                   7 
##             Enoplea         Tentaculata   Bacillariophyceae 
##                   3                   2                   3 
##     Dothideomycetes         Dinophyceae    Prymnesiophyceae 
##                   4                   2                   1 
##                Aves Coscinodiscophyceae         Ophiuroidea 
##                   1                   5                   1 
## Chlorodendrophyceae              Enopla              Anopla 
##                   1                   1                   2 
##         Turbellaria       Leotiomycetes 
##                   1                   1</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="identifier">blast_class_counts</span><span class="paren">)</span></code></pre>
<pre><code>##        Malacostraca         Maxillopoda         Actinopteri 
##                  24                  10                  98 
##         Cephalopoda         Sagittoidea            Mammalia 
##                   5                   1                   7 
##          Gastropoda      Eurotiomycetes           Oomycetes 
##                   4                   2                   1 
##           Ostracoda     Sordariomycetes             Insecta 
##                   1                   3                   4 
##                             Dinophyceae    Prymnesiophyceae 
##                   2                   1                   1 
##                Aves      Chondrichthyes         Ophiuroidea 
##                   1                   3                   1 
##            Hydrozoa Coscinodiscophyceae     Dothideomycetes 
##                   2                   1                   1 
##  Microbotryomycetes 
##                   1</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="identifier">sap_class_counts</span><span class="paren">)</span></code></pre>
<pre><code>##      Actinopteri   Chondrichthyes                      Malacostraca 
##               64                3               28               18 
##  Sordariomycetes       Gastropoda   Eurotiomycetes         Mammalia 
##                4                4                2                5 
##      Sagittoidea      Cephalopoda      Ophiuroidea  Dothideomycetes 
##                2                6                1                1 
##      Maxillopoda          Insecta             Aves         Oomycota 
##                9                3                1                1 
##        Ostracoda Prymnesiophyceae         Hydrozoa 
##                1                1                1</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="string">"Unique phylum counts (ID &gt;= .97 filter)"</span><span class="paren">)</span></code></pre>
<pre><code>## [1] "Unique phylum counts (ID &gt;= .97 filter)"</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="identifier">vsearch_phylum_counts</span><span class="paren">)</span></code></pre>
<pre><code>##       Arthropoda         Chordata         Mollusca     Chaetognatha 
##               37               98                9                1 
## Heterokontophyta       Ascomycota  Pyrrophycophyta                  
##                1                3                1                3 
##       Haptophyta    Echinodermata         Cnidaria  Bacillariophyta 
##                1                1                2                1 
##    Basidiomycota 
##                1</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="identifier">ecotag_phylum_counts</span><span class="paren">)</span></code></pre>
<pre><code>##         Nematoda  Platyhelminthes       Arthropoda     Chaetognatha 
##               10               19              190                5 
##      Apicomplexa       Ascomycota                     Basidiomycota 
##                4               35              251                6 
##         Chordata         Annelida         Mollusca     Hemichordata 
##              221               24               23                1 
##         Cnidaria Heterokontophyta       Ctenophora  Bacillariophyta 
##               10                1                2                8 
##  Pyrrophycophyta       Haptophyta         Nemertea    Echinodermata 
##                1                1                4                1 
##      Chlorophyta     Mucoromycota 
##                1                1</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="identifier">blast_phylum_counts</span><span class="paren">)</span></code></pre>
<pre><code>##       Arthropoda         Chordata         Mollusca     Chaetognatha 
##               39              110                9                1 
##       Ascomycota Heterokontophyta  Pyrrophycophyta       Haptophyta 
##                6                1                1                1 
##                     Echinodermata         Cnidaria  Bacillariophyta 
##                1                1                2                1 
##    Basidiomycota 
##                1</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="identifier">sap_phylum_counts</span><span class="paren">)</span></code></pre>
<pre><code>##         Chordata         Mollusca       Arthropoda       Ascomycota 
##               96               11               33                9 
##     Chaetognatha    Echinodermata Heterokontophyta       Haptophyta 
##                2                1                1                1 
##         Cnidaria 
##                1</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="string">"Unique kingdom counts (ID &gt;= .97 filter)"</span><span class="paren">)</span></code></pre>
<pre><code>## [1] "Unique kingdom counts (ID &gt;= .97 filter)"</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="identifier">vsearch_kingdom_counts</span><span class="paren">)</span></code></pre>
<pre><code>## Metazoa           Fungi 
##     148       7       4</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="identifier">ecotag_kingdom_counts</span><span class="paren">)</span></code></pre>
<pre><code>##       Metazoa                       Fungi Viridiplantae 
##           697            79            42             1</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="identifier">blast_kingdom_counts</span><span class="paren">)</span></code></pre>
<pre><code>## Metazoa   Fungi         
##     162       7       5</code></pre>
<pre class="r"><code class="r"><span class="identifier">print</span> <span class="paren">(</span><span class="identifier">sap_kingdom_counts</span><span class="paren">)</span></code></pre>
<pre><code>## Metazoa   Fungi         
##     144       9       2</code></pre>
<pre class="r"><code class="r"><span class="comment"># SAP c</span>

<span class="identifier">par</span><span class="paren">(</span><span class="identifier">mfrow</span><span class="operator">=</span><span class="identifier">c</span><span class="paren">(</span><span class="number">1</span>,<span class="number">3</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">vn_species</span> <span class="operator">&lt;-</span> <span class="identifier">list</span> <span class="paren">(</span><span class="number">0</span><span class="paren">)</span>
<span class="identifier">vn_species</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">vsearch_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">species</span>
<span class="identifier">vn_species</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">ecotag_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">species</span>
<span class="identifier">vn_species</span><span class="paren">[</span><span class="paren">[</span><span class="number">3</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">blast_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">species</span>
<span class="identifier">vn_species</span><span class="paren">[</span><span class="paren">[</span><span class="number">4</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">sap_taxonomy</span><span class="operator">$</span><span class="identifier">species</span>
<span class="identifier">names</span> <span class="paren">(</span><span class="identifier">vn_species</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"Vsearch"</span>, <span class="string">"Ecotag"</span>, <span class="string">"Blast"</span>, <span class="string">"SAP"</span><span class="paren">)</span>
<span class="identifier">plot</span> <span class="paren">(</span><span class="identifier">Venn</span> <span class="paren">(</span><span class="identifier">vn_species</span><span class="paren">)</span>, <span class="identifier">doWeights</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span></code></pre>
<p><img src="report_files/taxon_97_venn-1.png" width="672"></p>
<pre class="r"><code class="r"><span class="identifier">plot</span> <span class="paren">(</span><span class="identifier">Venn</span> <span class="paren">(</span><span class="identifier">vn_species</span><span class="paren">)</span>, <span class="identifier">doWeights</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></code></pre>
<p><img src="report_files/taxon_97_venn-2.png" width="672"></p>
<pre class="r"><code class="r"><span class="identifier">plot</span> <span class="paren">(</span><span class="identifier">Venn</span> <span class="paren">(</span><span class="identifier">vn_species</span><span class="paren">)</span>, <span class="identifier">doWeights</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">show</span> <span class="operator">=</span> <span class="identifier">list</span> <span class="paren">(</span><span class="identifier">SetLabels</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">FaceText</span> <span class="operator">=</span> <span class="string">""</span><span class="paren">)</span><span class="paren">)</span></code></pre>
<p><img src="report_files/taxon_97_venn-3.png" width="672"></p>
<pre class="r"><code class="r"><span class="identifier">vn_genus</span> <span class="operator">&lt;-</span> <span class="identifier">list</span> <span class="paren">(</span><span class="number">0</span><span class="paren">)</span>
<span class="identifier">vn_genus</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">vsearch_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">genus</span>
<span class="identifier">vn_genus</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">ecotag_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">genus</span>
<span class="identifier">vn_genus</span><span class="paren">[</span><span class="paren">[</span><span class="number">3</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">blast_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">genus</span>
<span class="identifier">vn_genus</span><span class="paren">[</span><span class="paren">[</span><span class="number">4</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">sap_taxonomy</span><span class="operator">$</span><span class="identifier">genus</span>
<span class="identifier">names</span> <span class="paren">(</span><span class="identifier">vn_genus</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"Vsearch"</span>, <span class="string">"Ecotag"</span>, <span class="string">"Blast"</span>, <span class="string">"SAP"</span><span class="paren">)</span>
<span class="identifier">plot</span> <span class="paren">(</span><span class="identifier">Venn</span> <span class="paren">(</span><span class="identifier">vn_genus</span><span class="paren">)</span>, <span class="identifier">doWeights</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span></code></pre>
<p><img src="report_files/taxon_97_venn-4.png" width="672"></p>
<pre class="r"><code class="r"><span class="identifier">vn_family</span> <span class="operator">&lt;-</span> <span class="identifier">list</span> <span class="paren">(</span><span class="number">0</span><span class="paren">)</span>
<span class="identifier">vn_family</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">vsearch_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">family</span>
<span class="identifier">vn_family</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">ecotag_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">family</span>
<span class="identifier">vn_family</span><span class="paren">[</span><span class="paren">[</span><span class="number">3</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">blast_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">family</span>
<span class="identifier">vn_family</span><span class="paren">[</span><span class="paren">[</span><span class="number">4</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">sap_taxonomy</span><span class="operator">$</span><span class="identifier">family</span>
<span class="identifier">names</span> <span class="paren">(</span><span class="identifier">vn_family</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"Vsearch"</span>, <span class="string">"Ecotag"</span>, <span class="string">"Blast"</span>, <span class="string">"SAP"</span><span class="paren">)</span>
<span class="identifier">plot</span> <span class="paren">(</span><span class="identifier">Venn</span> <span class="paren">(</span><span class="identifier">vn_family</span><span class="paren">)</span>, <span class="identifier">doWeights</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span></code></pre>
<p><img src="report_files/taxon_97_venn-5.png" width="672"></p>
<pre class="r"><code class="r"><span class="identifier">vn_order</span> <span class="operator">&lt;-</span> <span class="identifier">list</span> <span class="paren">(</span><span class="number">0</span><span class="paren">)</span>
<span class="identifier">vn_order</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">vsearch_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">order</span>
<span class="identifier">vn_order</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">ecotag_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">order</span>
<span class="identifier">vn_order</span><span class="paren">[</span><span class="paren">[</span><span class="number">3</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">blast_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">order</span>
<span class="identifier">vn_order</span><span class="paren">[</span><span class="paren">[</span><span class="number">4</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">sap_taxonomy</span><span class="operator">$</span><span class="identifier">order</span>
<span class="identifier">names</span> <span class="paren">(</span><span class="identifier">vn_order</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"Vsearch"</span>, <span class="string">"Ecotag"</span>, <span class="string">"Blast"</span>, <span class="string">"SAP"</span><span class="paren">)</span>
<span class="identifier">plot</span> <span class="paren">(</span><span class="identifier">Venn</span> <span class="paren">(</span><span class="identifier">vn_order</span><span class="paren">)</span>, <span class="identifier">doWeights</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span></code></pre>
<p><img src="report_files/taxon_97_venn-6.png" width="672"></p>
<pre class="r"><code class="r"><span class="identifier">vn_class</span> <span class="operator">&lt;-</span> <span class="identifier">list</span> <span class="paren">(</span><span class="number">0</span><span class="paren">)</span>
<span class="identifier">vn_class</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">vsearch_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">class</span>
<span class="identifier">vn_class</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">ecotag_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">class</span>
<span class="identifier">vn_class</span><span class="paren">[</span><span class="paren">[</span><span class="number">3</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">blast_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">class</span>
<span class="identifier">vn_class</span><span class="paren">[</span><span class="paren">[</span><span class="number">4</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">sap_taxonomy</span><span class="operator">$</span><span class="identifier">class</span>
<span class="identifier">names</span> <span class="paren">(</span><span class="identifier">vn_class</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"Vsearch"</span>, <span class="string">"Ecotag"</span>, <span class="string">"Blast"</span>, <span class="string">"SAP"</span><span class="paren">)</span>
<span class="identifier">plot</span> <span class="paren">(</span><span class="identifier">Venn</span> <span class="paren">(</span><span class="identifier">vn_class</span><span class="paren">)</span>, <span class="identifier">doWeights</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span></code></pre>
<p><img src="report_files/taxon_97_venn-7.png" width="672"></p>
<pre class="r"><code class="r"><span class="identifier">vn_phylum</span> <span class="operator">&lt;-</span> <span class="identifier">list</span> <span class="paren">(</span><span class="number">0</span><span class="paren">)</span>
<span class="identifier">vn_phylum</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">vsearch_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">phylum</span>
<span class="identifier">vn_phylum</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">ecotag_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">phylum</span>
<span class="identifier">vn_phylum</span><span class="paren">[</span><span class="paren">[</span><span class="number">3</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">blast_taxonomy_uniq</span><span class="operator">$</span><span class="identifier">phylum</span>
<span class="identifier">vn_phylum</span><span class="paren">[</span><span class="paren">[</span><span class="number">4</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">sap_taxonomy</span><span class="operator">$</span><span class="identifier">phylum</span>
<span class="identifier">names</span> <span class="paren">(</span><span class="identifier">vn_phylum</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"Vsearch"</span>, <span class="string">"Ecotag"</span>, <span class="string">"Blast"</span>, <span class="string">"SAP"</span><span class="paren">)</span>
<span class="identifier">plot</span> <span class="paren">(</span><span class="identifier">Venn</span> <span class="paren">(</span><span class="identifier">vn_phylum</span><span class="paren">)</span>, <span class="identifier">doWeights</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></code></pre>
<p><img src="report_files/taxon_97_venn-8.png" width="672"></p>
</div>
<div id="section-investigate-preditors" class="section level2">
<h2>Investigate preditors</h2>
<pre class="r"><code class="r"><span class="comment"># SAP todo</span>

<span class="identifier">Predators_Samples</span><span class="operator">$</span><span class="identifier">SAMPLE_ID</span> <span class="operator">&lt;-</span> <span class="identifier">make.names</span> <span class="paren">(</span><span class="identifier">Predators_Samples</span><span class="operator">$</span><span class="identifier">SAMPLE_ID</span><span class="paren">)</span>

<span class="comment"># Build critters vs tubes</span>

<span class="comment">##ovt_vsearch[ovt_vsearch$species == "Pseudorhombila quadridentata", "X558.A"]</span>

<span class="comment"># Fix a sample ID error</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ovt_vsearch</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">gsub</span> <span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ovt_vsearch</span><span class="paren">)</span>, <span class="identifier">pattern</span> <span class="operator">=</span> <span class="string">"B0"</span>, <span class="identifier">replacement</span> <span class="operator">=</span> <span class="string">"B"</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ovt_ecotag</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">gsub</span> <span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ovt_ecotag</span><span class="paren">)</span>, <span class="identifier">pattern</span> <span class="operator">=</span> <span class="string">"B0"</span>, <span class="identifier">replacement</span> <span class="operator">=</span> <span class="string">"B"</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ovt_blast</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">gsub</span> <span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ovt_blast</span><span class="paren">)</span>, <span class="identifier">pattern</span> <span class="operator">=</span> <span class="string">"B0"</span>, <span class="identifier">replacement</span> <span class="operator">=</span> <span class="string">"B"</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ovt_sap</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">gsub</span> <span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ovt_sap</span><span class="paren">)</span>, <span class="identifier">pattern</span> <span class="operator">=</span> <span class="string">"B0"</span>, <span class="identifier">replacement</span> <span class="operator">=</span> <span class="string">"B"</span><span class="paren">)</span>

<span class="identifier">predator_match_vsearch</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">Predators_Samples</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">1</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span> <span class="identifier">sum</span><span class="paren">(</span><span class="identifier">ovt_vsearch</span><span class="paren">[</span><span class="identifier">ovt_vsearch</span><span class="operator">$</span><span class="identifier">species</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span>, <span class="identifier">x</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>  <span class="paren">}</span><span class="paren">)</span>
<span class="identifier">predator_match_len_vsearch</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">predator_match_vsearch</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span><span class="identifier">x</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">}</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">predator_match_proportion_vsearch</span> <span class="operator">&lt;-</span> <span class="identifier">predator_match_len_vsearch</span> <span class="operator">/</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">samples</span><span class="paren">)</span>

<span class="identifier">predator_match_ecotag</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">Predators_Samples</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">1</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">ovt_ecotag</span><span class="paren">[</span><span class="identifier">ovt_ecotag</span><span class="operator">$</span><span class="identifier">species</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">x</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>  <span class="paren">}</span><span class="paren">)</span>
<span class="identifier">predator_match_len_ecotag</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">predator_match_ecotag</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span><span class="identifier">x</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">}</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">predator_match_proportion_ecotag</span> <span class="operator">&lt;-</span> <span class="identifier">predator_match_len_ecotag</span> <span class="operator">/</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">samples</span><span class="paren">)</span>

<span class="identifier">predator_match_blast</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">Predators_Samples</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">1</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">ovt_blast</span><span class="paren">[</span><span class="identifier">ovt_blast</span><span class="operator">$</span><span class="identifier">species</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">x</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>  <span class="paren">}</span><span class="paren">)</span>
<span class="identifier">predator_match_len_blast</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">predator_match_blast</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span><span class="identifier">x</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">}</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">predator_match_proportion_blast</span> <span class="operator">&lt;-</span> <span class="identifier">predator_match_len_blast</span> <span class="operator">/</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">samples</span><span class="paren">)</span>

<span class="identifier">predator_match_sap</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">Predators_Samples</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">1</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">ovt_blast</span><span class="paren">[</span><span class="identifier">ovt_sap</span><span class="operator">$</span><span class="identifier">species</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">x</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>  <span class="paren">}</span><span class="paren">)</span>
<span class="identifier">predator_match_len_sap</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">predator_match_sap</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span><span class="identifier">x</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">}</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">predator_match_proportion_sap</span> <span class="operator">&lt;-</span> <span class="identifier">predator_match_len_sap</span> <span class="operator">/</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">samples</span><span class="paren">)</span>

<span class="identifier">predator_match_proportions</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"Vsearch"</span>, <span class="string">"Ecotag"</span>, <span class="string">"Blast"</span>, <span class="string">"SAP"</span><span class="paren">)</span>,
                                                <span class="identifier">c</span> <span class="paren">(</span><span class="identifier">predator_match_proportion_vsearch</span>, <span class="identifier">predator_match_proportion_ecotag</span>, 
                                                   <span class="identifier">predator_match_proportion_blast</span>, <span class="identifier">predator_match_proportion_sap</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">colnames</span><span class="paren">(</span><span class="identifier">predator_match_proportions</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"source"</span>, <span class="string">"proportions"</span><span class="paren">)</span>


<span class="identifier">p1</span> <span class="operator">&lt;-</span> <span class="identifier">ggplot</span> <span class="paren">(</span><span class="identifier">data</span><span class="operator">=</span><span class="identifier">predator_match_proportions</span>, <span class="identifier">aes</span><span class="paren">(</span><span class="identifier">y</span><span class="operator">=</span><span class="identifier">proportions</span>, <span class="identifier">x</span><span class="operator">=</span><span class="keyword">source</span>, <span class="identifier">fill</span><span class="operator">=</span><span class="keyword">source</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">geom_bar</span><span class="paren">(</span><span class="identifier">stat</span><span class="operator">=</span><span class="string">"identity"</span>, <span class="identifier">color</span> <span class="operator">=</span> <span class="string">"black"</span> <span class="paren">)</span> <span class="operator">+</span> <span class="identifier">scale_fill_manual</span><span class="paren">(</span><span class="identifier">values</span><span class="operator">=</span><span class="identifier">c</span><span class="paren">(</span><span class="string">"#bebada"</span>, <span class="string">"#8dd3c7"</span>, <span class="string">"#ffaabc"</span>, <span class="string">"#ffffb3"</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">ylim</span><span class="paren">(</span><span class="number">0</span>,<span class="number">1</span><span class="paren">)</span>

<span class="identifier">plot</span> <span class="paren">(</span><span class="identifier">p1</span><span class="paren">)</span></code></pre>
<p><img src="report_files/preditors-1.png" width="672"></p>
<pre class="r"><code class="r"><span class="comment"># SAP complete</span>

<span class="comment">##ovt_vsearch[ovt_vsearch$species == "Sardinella aurita", "X1049.G"]</span>

<span class="comment"># Fix a sample ID error</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ovt_vsearch_97</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">gsub</span> <span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ovt_vsearch</span><span class="paren">)</span>, <span class="identifier">pattern</span> <span class="operator">=</span> <span class="string">"B0"</span>, <span class="identifier">replacement</span> <span class="operator">=</span> <span class="string">"B"</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ovt_ecotag_97</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">gsub</span> <span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ovt_ecotag</span><span class="paren">)</span>, <span class="identifier">pattern</span> <span class="operator">=</span> <span class="string">"B0"</span>, <span class="identifier">replacement</span> <span class="operator">=</span> <span class="string">"B"</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ovt_blast_97</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">gsub</span> <span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ovt_blast</span><span class="paren">)</span>, <span class="identifier">pattern</span> <span class="operator">=</span> <span class="string">"B0"</span>, <span class="identifier">replacement</span> <span class="operator">=</span> <span class="string">"B"</span><span class="paren">)</span>
<span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ovt_sap_97</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">gsub</span> <span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">colnames</span> <span class="paren">(</span><span class="identifier">ovt_sap</span><span class="paren">)</span>, <span class="identifier">pattern</span> <span class="operator">=</span> <span class="string">"B0"</span>, <span class="identifier">replacement</span> <span class="operator">=</span> <span class="string">"B"</span><span class="paren">)</span>

<span class="identifier">predator_match_vsearch</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">Predators_Samples</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">1</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">ovt_vsearch_97</span><span class="paren">[</span><span class="identifier">ovt_vsearch_97</span><span class="operator">$</span><span class="identifier">species</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">x</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>  <span class="paren">}</span><span class="paren">)</span>
<span class="identifier">predator_match_len_vsearch</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">predator_match_vsearch</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span><span class="identifier">x</span> <span class="operator">&gt;</span> <span class="number">0</span> <span class="paren">}</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">predator_match_proportion_vsearch</span> <span class="operator">&lt;-</span> <span class="identifier">predator_match_len_vsearch</span> <span class="operator">/</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">samples</span><span class="paren">)</span>

<span class="identifier">predator_match_ecotag</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">Predators_Samples</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">1</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">ovt_ecotag_97</span><span class="paren">[</span><span class="identifier">ovt_ecotag_97</span><span class="operator">$</span><span class="identifier">species</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">x</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>  <span class="paren">}</span><span class="paren">)</span>
<span class="identifier">predator_match_len_ecotag</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">predator_match_ecotag</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span><span class="identifier">x</span> <span class="operator">&gt;</span> <span class="number">0</span> <span class="paren">}</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">predator_match_proportion_ecotag</span> <span class="operator">&lt;-</span> <span class="identifier">predator_match_len_ecotag</span> <span class="operator">/</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">samples</span><span class="paren">)</span>

<span class="identifier">predator_match_blast</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">Predators_Samples</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">1</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">ovt_blast_97</span><span class="paren">[</span><span class="identifier">ovt_blast_97</span><span class="operator">$</span><span class="identifier">species</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">x</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>  <span class="paren">}</span><span class="paren">)</span>
<span class="identifier">predator_match_len_blast</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">predator_match_blast</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span><span class="identifier">x</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">}</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">predator_match_proportion_blast</span> <span class="operator">&lt;-</span> <span class="identifier">predator_match_len_blast</span> <span class="operator">/</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">samples</span><span class="paren">)</span>

<span class="identifier">predator_match_sap</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">Predators_Samples</span>, <span class="identifier">MARGIN</span> <span class="operator">=</span> <span class="number">1</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span> <span class="identifier">sum</span> <span class="paren">(</span><span class="identifier">ovt_blast_97</span><span class="paren">[</span><span class="identifier">ovt_sap_97</span><span class="operator">$</span><span class="identifier">species</span> <span class="operator">==</span> <span class="identifier">x</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">x</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>  <span class="paren">}</span><span class="paren">)</span>
<span class="identifier">predator_match_len_sap</span> <span class="operator">&lt;-</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">which</span> <span class="paren">(</span><span class="identifier">sapply</span> <span class="paren">(</span><span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">predator_match_sap</span>, <span class="identifier">FUN</span> <span class="operator">=</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span><span class="identifier">x</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">}</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">predator_match_proportion_sap</span> <span class="operator">&lt;-</span> <span class="identifier">predator_match_len_sap</span> <span class="operator">/</span> <span class="identifier">length</span> <span class="paren">(</span><span class="identifier">samples</span><span class="paren">)</span>

<span class="identifier">predator_match_proportions_97</span> <span class="operator">&lt;-</span> <span class="identifier">cbind.data.frame</span> <span class="paren">(</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"Vsearch"</span>, <span class="string">"Ecotag"</span>, <span class="string">"Blast"</span>, <span class="string">"SAP"</span><span class="paren">)</span>,
                                                <span class="identifier">c</span> <span class="paren">(</span><span class="identifier">predator_match_proportion_vsearch</span>, <span class="identifier">predator_match_proportion_ecotag</span>, 
                                                   <span class="identifier">predator_match_proportion_blast</span>, <span class="identifier">predator_match_proportion_sap</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">colnames</span><span class="paren">(</span><span class="identifier">predator_match_proportions_97</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span> <span class="paren">(</span><span class="string">"source"</span>, <span class="string">"proportions"</span><span class="paren">)</span>

<span class="identifier">p2</span> <span class="operator">&lt;-</span> <span class="identifier">ggplot</span> <span class="paren">(</span><span class="identifier">data</span><span class="operator">=</span><span class="identifier">predator_match_proportions_97</span>, <span class="identifier">aes</span><span class="paren">(</span><span class="identifier">y</span><span class="operator">=</span><span class="identifier">proportions</span>, <span class="identifier">x</span><span class="operator">=</span><span class="keyword">source</span>, <span class="identifier">fill</span><span class="operator">=</span><span class="keyword">source</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">geom_bar</span><span class="paren">(</span><span class="identifier">stat</span><span class="operator">=</span><span class="string">"identity"</span>, <span class="identifier">color</span> <span class="operator">=</span> <span class="string">"black"</span> <span class="paren">)</span> <span class="operator">+</span> <span class="identifier">scale_fill_manual</span><span class="paren">(</span><span class="identifier">values</span><span class="operator">=</span><span class="identifier">c</span><span class="paren">(</span><span class="string">"#bebada"</span>, <span class="string">"#8dd3c7"</span>, <span class="string">"#ffaabc"</span>, <span class="string">"#ffffb3"</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">ylim</span><span class="paren">(</span><span class="number">0</span>,<span class="number">1</span><span class="paren">)</span>

<span class="identifier">grid.arrange</span><span class="paren">(</span><span class="identifier">p1</span>, <span class="identifier">p2</span>, <span class="identifier">ncol</span><span class="operator">=</span><span class="number">2</span><span class="paren">)</span></code></pre>
<p><img src="report_files/preditors_97-1.png" width="672"></p>
<pre class="r"><code class="r"><span class="identifier">plot</span><span class="paren">(</span><span class="identifier">p2</span><span class="paren">)</span></code></pre>
<p><img src="report_files/preditors_97-2.png" width="672"></p>
</div>
<div id="section-compare-blast-and-sap-otu-assignments" class="section level2">
<h2>Compare Blast and SAP OTU assignments</h2>
<p>SAP should be able to assign wherever Blast did. However, SAP with 
default values did not come close. In order to experiment with SAP 
parameters, want to see what OTUs were assigned by Blast (after then id 
&gt;= .97 filter.) Of particular interest is the predators, since those 
assignments are very confident since we know those species should be 
represented.</p>
<table class="table table-condensed">
<thead>
<tr class="header">
<th>Intersection</th>
<th align="right">Number of Assigned OTUs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Blast assignments</td>
<td align="right">174</td>
</tr>
<tr class="even">
<td>SAP assignments</td>
<td align="right">155</td>
</tr>
<tr class="odd">
<td>Total OTU assignments</td>
<td align="right">199</td>
</tr>
<tr class="even">
<td>OTUs that only Blast assigned</td>
<td align="right">44</td>
</tr>
<tr class="odd">
<td>OTUs that only SAP assigned</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td>Cases where Blast and SAP assigned same species</td>
<td align="right">47</td>
</tr>
<tr class="odd">
<td>Cases where Blast and SAP both assigned species, but mismatched</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td>Cases where SAP did a higher-level assignment</td>
<td align="right">97</td>
</tr>
<tr class="odd">
<td>Cases where SAP had a species-level assignment and no Blast assignment</td>
<td align="right">8</td>
</tr>
</tbody>
</table>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "mathjax-local/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>


</div>
  </div>



</body></html>